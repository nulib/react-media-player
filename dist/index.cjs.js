var tr=Object.create;var K=Object.defineProperty,rr=Object.defineProperties,or=Object.getOwnPropertyDescriptor,nr=Object.getOwnPropertyDescriptors,ir=Object.getOwnPropertyNames,Se=Object.getOwnPropertySymbols,ar=Object.getPrototypeOf,Fe=Object.prototype.hasOwnProperty,sr=Object.prototype.propertyIsEnumerable;var Te=(e,t,r)=>t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,C=(e,t)=>{for(var r in t||(t={}))Fe.call(t,r)&&Te(e,r,t[r]);if(Se)for(var r of Se(t))sr.call(t,r)&&Te(e,r,t[r]);return e},O=(e,t)=>rr(e,nr(t));var lr=(e,t)=>{for(var r in t)K(e,r,{get:t[r],enumerable:!0})},ke=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ir(t))!Fe.call(e,o)&&o!==r&&K(e,o,{get:()=>t[o],enumerable:!(n=or(t,o))||n.enumerable});return e};var f=(e,t,r)=>(r=e!=null?tr(ar(e)):{},ke(t||!e||!e.__esModule?K(r,"default",{value:e,enumerable:!0}):r,e)),dr=e=>ke(K({},"__esModule",{value:!0}),e);var jr={};lr(jr,{default:()=>Gr});module.exports=dr(jr);var w=f(require("react"));var N=f(require("react")),Ee=require("@iiif/vault"),Ae={showTitle:!0,showIIIFBadge:!0,ignoreCaptionLabels:[]},pe={activeCanvas:"",configOptions:Ae,isLoaded:!1,vault:new Ee.Vault},Ve=N.default.createContext(pe),Pe=N.default.createContext(pe);function pr(e,t){switch(t.type){case"updateActiveCanvas":return t.canvasId||(t.canvasId=""),O(C({},e),{activeCanvas:t.canvasId});case"updateConfigOptions":return O(C({},e),{configOptions:C(C({},Ae),t.configOptions)});case"updateIsLoaded":return O(C({},e),{isLoaded:t.isLoaded});default:throw new Error(`Unhandled action type: ${t.type}`)}}var $e=({initialState:e=pe,children:t})=>{let[r,n]=N.default.useReducer(pr,e);return N.default.createElement(Ve.Provider,{value:r},N.default.createElement(Pe.Provider,{value:n},t))};function W(){let e=N.default.useContext(Ve);if(e===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return e}function Y(){let e=N.default.useContext(Pe);if(e===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return e}var v=f(require("react"));function We(e){return e.service?`${e.service[0].id}/full/,${e.height||500}/0/default.jpg`:e.id}var ce=e=>{if(!!e)try{let t=e.thumbnail;return t&&t.length>0?We(t[0]):We(e.items[0].items[0].body)}catch(t){console.error("Error retrieving accompanying canvas image",t);return}};var D=(e,t,r,n)=>{var i,l;let o={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},a=d=>{if(d){if(!d.body||!d.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",d);return}if(!d.body)return;let p=d.body;Array.isArray(p)&&(p=p[0]);let g=e.get(p.id);if(!g)return;switch(r){case"painting":return d.target===t.id&&d.motivation&&d.motivation[0]==="painting"&&n.includes(g.type)&&(d.body=g),d;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};return o.canvas=e.get(t),o.canvas&&(o.annotationPage=e.get(o.canvas.items[0]),o.accompanyingCanvas=(i=o.canvas)!=null&&i.accompanyingCanvas?e.get((l=o.canvas)==null?void 0:l.accompanyingCanvas):void 0),o.annotationPage&&(o.annotations=e.get(o.annotationPage.items).filter(a)),o};var me=(e,t)=>{let r=D(e,{id:t,type:"Canvas"},"painting",["Image","Sound","Video"]);if(r.annotations.length!==0&&r.annotations[0]&&r.annotations[0].body)return r.annotations[0].body};var ue=(e,t,r)=>{let n=e.get({id:t,type:"Canvas"});if(!(n!=null&&n.annotations)||!n.annotations[0])return[];let o=e.get(n.annotations[0]),a=e.get(o.items);return Array.isArray(a)?a.filter(i=>{var l;if(!!i.body&&(l=i.motivation)!=null&&l.includes("supplementing")){let d=i.body;Array.isArray(d)&&(d=d[0]);let p=e.get(d.id);if(p.format===r)return i.body=p,i}}).map(i=>i.body):[]};var F=(e,t="en")=>{if(!e)return"";if(!e[t]){let r=Object.getOwnPropertyNames(e);if(r.length>0)return e[r[0]]}return e[t]};var fe=(e,t,r,n)=>{let o=[];if(t.canvas&&t.canvas.thumbnail.length>0){let l=e.get(t.canvas.thumbnail[0]);o.push(l)}if(t.annotations[0]){if(t.annotations[0].thumbnail&&t.annotations[0].thumbnail.length>0){let d=e.get(t.annotations[0].thumbnail[0]);o.push(d)}if(!t.annotations[0].body)return;let l=t.annotations[0].body;l.type==="Image"&&o.push(l)}return o.length===0?void 0:{id:o[0].id,format:o[0].format,type:o[0].type,width:r,height:n}};var Me=require("@stitches/react"),cr={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"#006adc",accentMuted:"#5eb0ef",accentAlt:"#00254d",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fonts:{sans:"'Inter', Arial, sans-serif",display:"'Calistoga', 'Inter', Arial, sans-serif"},transitions:{all:"all 500ms cubic-bezier(0.16, 1, 0.3, 1)"}},ge={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",xl:"(max-width: 1199px)",lg:"(min-width: 1200px)"},{styled:s,css:so,keyframes:Le,createTheme:lo}=(0,Me.createStitches)({theme:cr,media:ge});var J=f(require("@radix-ui/react-collapsible")),he=s("div",{position:"relative",zIndex:"0"}),ye=s("div",{display:"flex",flexDirection:"row",overflow:"hidden","@sm":{flexDirection:"column"}}),be=s("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),ze=s(J.Trigger,{display:"none",background:"transparent",border:"none",margin:"0",padding:"0",transition:"$all",opacity:"1",marginTop:"0","&[data-navigator='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",margin:"1rem 1rem 0"}}}),xe=s(J.Content,{width:"100%",display:"flex"}),Ne=s("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%","@sm":{width:"100%"}}),Be=s("section",{display:"flex",flexDirection:"column",padding:"1.618rem",fontFamily:"$sans",backgroundColor:"$secondary",fontSmooth:"auto",webkitFontSmoothing:"antialiased","> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start","@sm":{[`& ${ye}`]:{flexGrow:"1"},[`& ${be}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-navigator-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${he}`]:{display:"none"},[`& ${xe}`]:{height:"100%"}}}});var ee=require("react"),Re=e=>{let t=()=>window.matchMedia?window.matchMedia(e).matches:!1,[r,n]=(0,ee.useState)(t);return(0,ee.useEffect)(()=>{let o=()=>n(t);return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)}),r};var H=require("react"),De=(e=!1)=>{let[t,r]=(0,H.useState)(e);return(0,H.useLayoutEffect)(()=>{if(!t)return;let n=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=n}},[t]),(0,H.useEffect)(()=>{t!==e&&r(e)},[e]),[t,r]};var Xt=f(require("@radix-ui/react-collapsible"));var M=f(require("react"));var ve=require("@nulib/design-system"),Oe=s(ve.Popover.Trigger,{width:"30px",padding:"5px"}),He=s(ve.Popover.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",button:{display:"flex",textDecoration:"none",fontFamily:"$sans",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none",["&:last-child"]:{marginBottom:"0"}}}),Ge=s("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",padding:"0 0 0.5rem",span:{fontSize:"1.25rem",fontWeight:"700",fontFamily:"$display","@sm":{padding:"1rem",fontSize:"1rem"}}});var Ue=require("@nulib/design-system");var A=f(require("react")),mr=()=>{let e="#ed1d33",t="#2873ab";return A.default.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},A.default.createElement("title",null,"IIIF Manifest Options"),A.default.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},A.default.createElement("g",{transform:"scale(0.1)"},A.default.createElement("path",{style:{fill:t},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),A.default.createElement("path",{style:{fill:t},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),A.default.createElement("path",{style:{fill:e},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),A.default.createElement("path",{style:{fill:e},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),A.default.createElement("path",{style:{fill:t},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),A.default.createElement("path",{style:{fill:t},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),A.default.createElement("path",{style:{fill:e},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},je=mr;var te=f(require("react"));var G=require("react"),Ze=(e,t=2500)=>{let[r,n]=(0,G.useState)(),o=(0,G.useCallback)(()=>{navigator.clipboard.writeText(e).then(()=>n("copied"),()=>n("failed"))},[e]);return(0,G.useEffect)(()=>{if(!r)return;let a=setTimeout(()=>n(void 0),t);return()=>clearTimeout(a)},[r]),[r,o]};var ur=s("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),fr=({status:e})=>e?te.default.createElement(ur,{"data-copy-status":e},e):null,gr=({textPrompt:e,textToCopy:t})=>{let[r,n]=Ze(t);return te.default.createElement("button",{onClick:n},e," ",te.default.createElement(fr,{status:r}))},Ke=gr;var hr=({manifestId:e,manifestLabel:t})=>{let r=W(),{configOptions:n}=r;return M.default.createElement(Ge,null,n.showTitle&&M.default.createElement("span",null,F(t,"en")),M.default.createElement("p",null,"Is this real"),n.showIIIFBadge&&M.default.createElement(Ue.Popover,null,M.default.createElement(Oe,null,M.default.createElement(je,null)),M.default.createElement(He,null,M.default.createElement("button",{onClick:o=>{o.preventDefault(),window.open(e,"_blank")}},"View Manifest"),M.default.createElement(Ke,{textPrompt:"Copy Manifest URL",textToCopy:e}))))},_e=hr;var E=f(require("react"));var I=f(require("react"));var qe=f(require("@radix-ui/react-radio-group"));var Qe=s(qe.Root,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem 0.618rem 1.618rem 0 ",overflowX:"scroll",position:"relative",zIndex:"0","@sm":{padding:"1rem"}});var x=f(require("react"));var yr=e=>{var t=e.toString().split(":"),r=Math.ceil(parseInt(t[0])),n=Math.ceil(parseInt(t[1])),o=br(Math.ceil(parseInt(t[2])),2);let i=`${r!==0&&n<10?(n+"").padStart(2,"0"):n}:${o}`;return r!==0&&(i=`${r}:${i}`),i},re=e=>{let t=new Date(e*1e3).toISOString().substr(11,8);return yr(t)};var br=(e,t)=>String(e).padStart(t,"0");var B=require("@nulib/design-system");var Xe=f(require("@radix-ui/react-radio-group"));var Ce=require("@nulib/design-system"),oe=s("span",{display:"flex"}),Ye=s("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),Je=s("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),et=s(Xe.Item,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},"@sm":{margin:"0 1rem 0 0","&:last-child":{marginRight:"0"}},figure:{margin:"0",width:"161.8px","@sm":{width:"123px"},"> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all","@sm":{height:"76px"},img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${oe}`]:{position:"absolute",right:"0.5rem",bottom:"0.5rem","@sm":{right:"0",bottom:"0"},[`& ${Ce.Tag}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary","@sm":{borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}}},figcaption:{marginTop:"0.5rem",color:"$primaryMuted",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${oe}`]:{[`& ${Ce.Tag}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700",color:"$primary"}}});var xr=({type:e})=>{switch(e){case"Sound":return x.default.createElement(B.Icon.Audio,null);case"Image":return x.default.createElement(B.Icon.Image,null);case"Video":return x.default.createElement(B.Icon.Video,null);default:return x.default.createElement(B.Icon.Image,null)}},vr=({canvas:e,canvasIndex:t,isActive:r,thumbnail:n,type:o,handleChange:a})=>{let i=F(e.label,"en");return x.default.createElement(et,{"aria-checked":r,"data-testid":"media-thumbnail","data-canvas":t,onClick:()=>a(e.id),value:e.id},x.default.createElement("figure",null,x.default.createElement("div",null,(n==null?void 0:n.id)&&x.default.createElement("img",{src:n.id,alt:i}),x.default.createElement(oe,null,x.default.createElement(B.Tag,{isIcon:!0,"data-testid":"thumbnail-tag"},x.default.createElement(Ye,null),x.default.createElement(B.Icon,{"aria-label":o},x.default.createElement(xr,{type:o})),["Video","Sound"].includes(o)&&x.default.createElement(Je,null,re(e.duration))))),x.default.createElement("figcaption",{"data-testid":"fig-caption"},i)))},tt=vr;var rt=e=>e.body?e.body.type:"Image";var u=f(require("react"));var Ie=s("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),ot=s("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"$sans",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),U=s("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),nt=s("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"},[`& ${U}`]:{}}),it=s("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${Ie}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}});var at=require("react"),Cr=(e,t)=>{(0,at.useEffect)(()=>{function r(n){n.key===e&&t()}return window.addEventListener("keyup",r),()=>window.removeEventListener("keyup",r)},[])},st=Cr;var Ir=()=>u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},u.default.createElement("title",null,"Arrow Back"),u.default.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),wr=()=>u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},u.default.createElement("title",null,"Arrow Forward"),u.default.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),Sr=()=>u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},u.default.createElement("title",null,"Close"),u.default.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Tr=()=>u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},u.default.createElement("title",null,"Search"),u.default.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),Fr=({handleCanvasToggle:e,handleFilter:t,activeIndex:r,canvasLength:n})=>{let[o,a]=(0,u.useState)(!1),[i,l]=(0,u.useState)(!1),[d,p]=(0,u.useState)(!1);(0,u.useEffect)(()=>{p(r===0),r===n-1?l(!0):l(!1)},[r]),st("Escape",()=>{a(!1),t("")});let g=()=>{a(y=>!y),t("")};return u.default.createElement(it,{isToggle:o},u.default.createElement(Ie,null,o&&u.default.createElement(ot,{autoFocus:!0,onChange:y=>t(y.target.value),placeholder:"Search"}),!o&&u.default.createElement(nt,null,u.default.createElement(U,{onClick:()=>e(-1),disabled:d,type:"button"},u.default.createElement(Ir,null)),u.default.createElement("span",null,r+1," of ",n),u.default.createElement(U,{onClick:()=>e(1),disabled:i,type:"button"},u.default.createElement(wr,null))),u.default.createElement(U,{onClick:g,type:"button"},o?u.default.createElement(Sr,null):u.default.createElement(Tr,null))))},lt=Fr;var kr=({items:e})=>{let t=Y(),r=W(),{activeCanvas:n,vault:o}=r,[a,i]=(0,I.useState)(""),[l,d]=(0,I.useState)([]),[p,g]=(0,I.useState)(0),h=I.default.useRef(null),y="painting",S=["Image","Sound","Video"],c=m=>{n!==m&&t({type:"updateActiveCanvas",canvasId:m})};return(0,I.useEffect)(()=>{for(let m of e){let b=D(o,m,y,S);b.annotations.length>0&&d($=>[...$,b])}},[]),(0,I.useEffect)(()=>{l.forEach((m,b)=>{m!=null&&m.canvas&&m.canvas.id===n&&g(b)})},[n]),(0,I.useEffect)(()=>{let m=document.querySelector(`[data-canvas="${p}"]`);if(m instanceof HTMLElement&&h.current){let b=m.offsetLeft-h.current.offsetWidth/2+m.offsetWidth/2;h.current.scrollTo({left:b,behavior:"smooth"})}},[p]),I.default.createElement(I.default.Fragment,null,I.default.createElement(lt,{handleFilter:m=>i(m),handleCanvasToggle:m=>{let b=l[p+m];b!=null&&b.canvas&&c(b.canvas.id)},activeIndex:p,canvasLength:l.length}),I.default.createElement(Qe,{"aria-label":"select item","data-testid":"media",ref:h},l.filter(m=>{var b;if((b=m.canvas)!=null&&b.label){let $=F(m.canvas.label);if(Array.isArray($))return $[0].toLowerCase().includes(a.toLowerCase())}}).map((m,b)=>{var $,we;return I.default.createElement(tt,{canvas:m.canvas,canvasIndex:b,handleChange:c,isActive:n===(($=m==null?void 0:m.canvas)==null?void 0:$.id),key:(we=m==null?void 0:m.canvas)==null?void 0:we.id,thumbnail:fe(o,m,200,200),type:rt(m.annotations[0])})})))},dt=kr;var k=f(require("react"));var R=f(require("@radix-ui/react-tabs"));var pt=s(R.Root,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",boxShadow:"-5px -5px 5px #00000011","@sm":{marginTop:"0.5rem",boxShadow:"none"},"&:after":{position:"absolute",bottom:0,content:"",width:"100%",height:"1rem",backgroundImage:"linear-gradient(0deg, #FFFFFF 0%, #FFFFFF00 100%)",zIndex:1,"@sm":{backgroundImage:"none"}}}),ct=s(R.List,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid $secondaryAlt",backgroundColor:"$secondary","@sm":{margin:"0 1rem"}}),mt=s(R.Trigger,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",color:"$primaryMuted",border:"none",fontFamily:"inherit",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:700,transition:"$all","&::after":{width:"0",height:"4px",content:"",backgroundColor:"$primaryMuted",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&:hover":{color:"$primary"},"&[data-state='active']":{color:"$accent","&::after":{width:"100%",backgroundColor:"$accent"}}}),ut=s(R.Content,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1rem 0"}}),ft=s("div",{position:"relative",height:"100%",width:"100%",overflowY:"scroll"});var j=f(require("react"));var ne=f(require("@radix-ui/react-radio-group"));var gt=Le({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),ht=s(ne.Root,{display:"flex",flexDirection:"column",width:"100%"}),ie=s(ne.Item,{position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"$primaryMuted",border:"none",background:"none","@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{color:"$primary",backgroundColor:"$secondaryMuted",fontFamily:"$sansBold","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:gt,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:gt,boxSizing:"content-box","@sm":{content:"unset"}}}});var yt=require("uuid"),Er=()=>{function e(o){return o.map(i=>{let l=i.identifier||(0,yt.v4)();return O(C({},i),{identifier:l})})}function t(o){let a=e(o);function i(d,p){let g=[];return d.forEach(h=>{let S=d.filter(c=>h.start>=c.start&&h.end<=c.end&&h.identifier!==c.identifier).sort((c,P)=>{let z=c.end-c.start,m=P.end-P.start;return z===m?0:z<m?-1:1})[0];if(!S&&!p||(S==null?void 0:S.identifier)===p){let c=i(d,h.identifier);c.length&&(h.children=c),g.push(h)}}),g}return i(a,null)}function r(o,a=[]){return a.some(i=>o.start>=i.start&&o.end<=i.end)}function n(o=[]){return o.sort((a,i)=>a.start-i.start)}return{addIdentifiersToParsedCues:e,createNestedCues:t,isChild:r,orderCuesByTime:n}},bt=Er;var Q=f(require("react"));var ae=f(require("react"));var _=f(require("react")),xt={currentTime:0,startTime:0,updateStartTime:()=>{},updateCurrentTime:()=>{}},q=_.default.createContext(xt),vt=({children:e})=>{let[t,r]=_.default.useState(xt.currentTime),[n,o]=_.default.useState(0),a=l=>o(l),i=l=>r(l);return _.default.createElement(q.Provider,{value:{currentTime:t,startTime:n,updateStartTime:a,updateCurrentTime:i}},e)};var Ar=({label:e,start:t,end:r})=>{let{currentTime:n,updateStartTime:o}=ae.default.useContext(q),a=t<=n&&n<r;return ae.default.createElement(ie,{"aria-checked":a,"data-testid":"navigator-cue",onClick:()=>{o(t)},value:e},e,ae.default.createElement("strong",null,re(t)))},Ct=Ar;var It=s("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${ie}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}});var wt=({items:e})=>Q.default.createElement(It,null,e.map(({text:t,start:r,end:n,children:o,identifier:a})=>Q.default.createElement("li",{key:a},Q.default.createElement(Ct,{label:t,start:r,end:n}),o&&Q.default.createElement(wt,{items:o})))),St=wt;var Tt=require("node-webvtt"),Vr=({resource:e})=>{let[t,r]=j.default.useState([]),{id:n,label:o}=e,{createNestedCues:a,orderCuesByTime:i}=bt();return(0,j.useEffect)(()=>{fetch(n,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(l=>l.text()).then(l=>{let d=(0,Tt.parse)(l).cues,p=i(d),g=a(p);r(g)}).catch(l=>console.error(n,l.toString()))},[n]),j.default.createElement(ht,{"aria-label":`navigate ${F(o,"en")}`},j.default.createElement(St,{items:t}))},Ft=Vr;var Pr=({activeCanvas:e,defaultResource:t,resources:r})=>{let[n,o]=(0,k.useState)(t);(0,k.useEffect)(()=>{o(t)},[e,r]);let a=i=>{o(i)};return r?k.default.createElement(pt,{"data-testid":"navigator",defaultValue:t,onValueChange:a,orientation:"horizontal",value:n},k.default.createElement(ct,{"aria-label":"select chapter","data-testid":"navigator-list"},r.map(({id:i,label:l})=>k.default.createElement(mt,{key:i,value:i},F(l,"en")))),k.default.createElement(ft,null,r.map(i=>k.default.createElement(ut,{key:i.id,value:i.id},k.default.createElement(Ft,{resource:i}))))):k.default.createElement(k.default.Fragment,null)},kt=Pr;var L=f(require("react")),Z=f(require("hls.js"));var Et=s("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",maxHeight:"450px",zIndex:"1",video:{backgroundColor:"transparent",display:"flex",position:"relative",objectFit:"contain",width:"100%",height:"100%",zIndex:"1"}});var X=f(require("react"));var At=s("canvas",{position:"absolute",width:"100%",height:"100%"});var $r=X.default.forwardRef((e,t)=>{let r=X.default.useRef(null);X.default.useEffect(()=>{!t||(t.current.onplay=n)},[t]);function n(){let a=t.current,i=new AudioContext,l=i.createMediaElementSource(a),d=i.createAnalyser(),p=r.current;if(!p)return;p.width=a.offsetWidth,p.height=a.offsetHeight;let g=p.getContext("2d");l.connect(d),d.connect(i.destination),d.fftSize=256;let h=d.frequencyBinCount,y=new Uint8Array(h);setInterval(function(){o(d,g,h,y,p.width,p.height)},20)}function o(a,i,l,d,p,g){let h=p/l*2.6,y,S=0;a.getByteFrequencyData(d),i.fillStyle="#000000",i.fillRect(0,0,p,g);for(let c=0;c<l;c++)y=d[c]*2,i.fillStyle=`rgba(${78}, 42, 132, 1)`,i.fillRect(S,g-y,h,y),S+=h+6}return X.default.createElement(At,{ref:r})}),Vt=$r;var Pt=f(require("react"));var Wr=({resource:e,ignoreCaptionLabels:t})=>{let r=F(e.label,"en");return r.some(o=>t.includes(o))?null:Pt.default.createElement("track",{key:e.id,src:e.id,label:r,srcLang:"en","data-testid":"player-track"})},$t=Wr;var Mr=({painting:e,resources:t})=>{var S;let r=L.default.useRef(null),n=(S=e==null?void 0:e.format)==null?void 0:S.includes("audio/"),{startTime:o,updateCurrentTime:a}=L.default.useContext(q),i=W(),{activeCanvas:l,configOptions:d,vault:p}=i,g=D(p,{id:l,type:"Canvas"},"painting",["Image"]),h=ce(g.accompanyingCanvas);L.default.useEffect(()=>{if(!e.id||!r.current||e.id.split(".").pop()!=="m3u8")return;let c=new Z.default;return c.attachMedia(r.current),c.on(Z.default.Events.MEDIA_ATTACHED,function(){c.loadSource(e.id)}),c.on(Z.default.Events.ERROR,function(P,z){if(z.fatal)switch(z.type){case Z.default.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${P} network error encountered, try to recover`),c.startLoad();break;case Z.default.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${P} media error encountered, try to recover`),c.recoverMediaError();break;default:c.destroy();break}}),()=>{c&&(c.detachMedia(),c.destroy(),a(0))}},[e.id]),L.default.useEffect(()=>{let c=r.current;c&&(c.currentTime=o),o!==0&&c.play()},[o]);let y=()=>{let c=r.current;c&&(c.ontimeupdate=P=>{a(P.target.currentTime)})};return L.default.createElement(Et,null,L.default.createElement("video",{id:"clover-iiif-video",key:e.id,ref:r,controls:!0,height:e.height,width:e.width,onPlay:y,crossOrigin:"anonymous",poster:h},L.default.createElement("source",{src:e.id,type:e.format}),t.length>0&&t.map(c=>L.default.createElement($t,{resource:c,ignoreCaptionLabels:d.ignoreCaptionLabels,key:c.id})),"Sorry, your browser doesn't support embedded videos."),n&&L.default.createElement(Vt,{ref:r}))},Wt=Mr;var V=f(require("react")),Gt=f(require("openseadragon"));var Mt=s("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px","#openseadragon-navigator-displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"}}),Lt=s("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),zt=s("div",{width:"100%",height:"450px",background:"black",backgroundSize:"contain",color:"white",position:"relative",zIndex:"1",overflow:"hidden"});var T=f(require("react"));var se=f(require("react"));var Nt=require("@stitches/react"),Bt=(0,Nt.styled)("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",backgroundColor:"#000D",filter:"drop-shadow(5px 5px 5px #0006)",transition:"$all",boxSizing:"content-box !important",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(5px 5px 5px #000D)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&#zoomReset":{"&:hover, &:focus":{svg:{rotate:"45deg"}}}});var Lr=({id:e,label:t,children:r})=>se.default.createElement(Bt,{id:e,"data-testid":"openseadragon-button"},se.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${e}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},se.default.createElement("title",{id:`${e}-svg-title`},t),r)),le=Lr;var Rt=require("@stitches/react"),Dt=(0,Rt.styled)("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem"});var zr=()=>T.default.createElement(Dt,{"data-testid":"openseadragon-controls",id:"openseadragon-controls"},T.default.createElement(le,{id:"zoomIn",label:"zoom in"},T.default.createElement(()=>T.default.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),null)),T.default.createElement(le,{id:"zoomOut",label:"zoom in"},T.default.createElement(()=>T.default.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),null)),T.default.createElement(le,{id:"zoomReset",label:"reset zoom"},T.default.createElement(()=>T.default.createElement(T.default.Fragment,null,T.default.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),T.default.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),null))),Ot=zr;var Ht=e=>fetch(`${e.replace(/\/$/,"")}/info.json`).then(t=>t.json()).then(t=>t).catch(t=>{console.error(`The IIIF tilesource ${e.replace(/\/$/,"")}/info.json failed to load: ${t}`)});var Nr=({service:e})=>{let[t,r]=(0,V.useState)(),[n,o]=(0,V.useState)();(0,V.useEffect)(()=>(a(),()=>{t==null||t.destroy()}),[]),(0,V.useEffect)(()=>{Array.isArray(e)&&o(e[0])},[e]),(0,V.useEffect)(()=>{if(n){let i;"@id"in n?i=n["@id"]:i=n.id,i&&Ht(i).then(l=>t==null?void 0:t.open(l))}},[t,n]);function a(){let i={homeButton:"zoomReset",showFullPageControl:!1,zoomInButton:"zoomIn",zoomOutButton:"zoomOut"},l={showNavigator:!0,navigatorBorderColor:"transparent",navigatorId:"openseadragon-navigator"};r((0,Gt.default)(C(C({id:"openseadragon-viewport",loadTilesWithAjax:!0},i),l)))}return V.default.createElement(zt,{"data-testid":"image-viewer"},V.default.createElement(Ot,null),V.default.createElement(Mt,{id:"openseadragon-navigator"}),V.default.createElement(Lt,{id:"openseadragon-viewport"}))},jt=Nr;var Zt=require("@nulib/design-system");var Br=({activeCanvas:e,painting:t,resources:r,items:n,isMedia:o,isNavigator:a,isNavigatorOpen:i})=>E.default.createElement(ye,null,E.default.createElement(vt,null,E.default.createElement(be,null,o?E.default.createElement(Wt,{painting:t,resources:r}):E.default.createElement(jt,C({},t)),E.default.createElement(ze,{"data-navigator":a},E.default.createElement(Zt.Button,{as:"span"},i?"View Media Items":"View Navigator")),n.length>1&&E.default.createElement(he,null,E.default.createElement(dt,{items:n,activeItem:0}))),a&&E.default.createElement(Ne,null,E.default.createElement(xe,null,E.default.createElement(kt,{activeCanvas:e,defaultResource:r[0].id,resources:r}))))),Kt=Br;var de=f(require("react"));var Ut=s("div",{display:"flex",flexDirection:"column",alignItems:"center"}),_t=s("p",{fontFamily:"$display",fontWeight:"bold",fontSize:"x-large"}),qt=s("span",{fontSize:"medium"});var Rr=({error:e})=>{let{message:t}=e;return de.default.createElement(Ut,{role:"alert"},de.default.createElement(_t,{"data-testid":"headline"},"Something went wrong"),t&&de.default.createElement(qt,null,`Error message: ${t}`," "))},Qt=Rr;var Yt=require("react-error-boundary"),Dr=({manifest:e,theme:t})=>{let r=W(),{activeCanvas:n,vault:o}=r,[a,i]=(0,v.useState)(!1),[l,d]=(0,v.useState)(!1),[p,g]=(0,v.useState)(!0),[h,y]=(0,v.useState)(void 0),[S,c]=(0,v.useState)([]),[P,z]=De(!1),m=Re(ge.sm);return(0,v.useEffect)(()=>{if(!m){g(!0);return}g(!1)},[m]),(0,v.useEffect)(()=>{if(!m){z(!1);return}z(p)},[p]),(0,v.useEffect)(()=>{let b=me(o,n),$=ue(o,n,"text/vtt");b&&(i(["Sound","Video"].indexOf(b.type)>-1),y(C({},b))),c($),d($.length!==0)},[n]),v.default.createElement(Yt.ErrorBoundary,{FallbackComponent:Qt},v.default.createElement(Be,{className:t,"data-body-locked":P,"data-navigator":l,"data-navigator-open":p},v.default.createElement(Xt.Root,{open:p,onOpenChange:g},v.default.createElement(_e,{manifestLabel:e.label,manifestId:e.id}),v.default.createElement(Kt,{activeCanvas:n,painting:h,resources:S,items:e.items,isMedia:a,isNavigator:l,isNavigatorOpen:p}))))},Jt=Dr;var er=require("@stitches/react"),Or=({manifestId:e,canvasIdCallback:t=()=>{},customTheme:r,options:n})=>w.default.createElement($e,null,w.default.createElement(Hr,{manifestId:e,canvasIdCallback:t,customTheme:r,options:n})),Hr=({manifestId:e,canvasIdCallback:t,customTheme:r,options:n})=>{let o=Y(),a=W(),{activeCanvas:i,isLoaded:l,vault:d}=a,[p,g]=(0,w.useState)(),h={};return r&&(h=(0,er.createTheme)("custom",r)),(0,w.useEffect)(()=>{t&&t(i)},[i]),(0,w.useEffect)(()=>{o({type:"updateConfigOptions",configOptions:n}),d.loadManifest(e).then(y=>{g(y),o({type:"updateActiveCanvas",canvasId:y.items[0]&&y.items[0].id})}).catch(y=>{console.error(`Manifest failed to load: ${y}`)}).finally(()=>{o({type:"updateIsLoaded",isLoaded:!0})})},[]),l?!p||!p.items?(console.log(`The IIIF manifest ${e} failed to load.`),w.default.createElement(w.default.Fragment,null)):p.items.length===0?(console.log(`The IIIF manifest ${e} does not contain canvases.`),w.default.createElement(w.default.Fragment,null)):w.default.createElement(Jt,{manifest:p,theme:h}):w.default.createElement(w.default.Fragment,null,"Loading")},Gr=Or;
//# sourceMappingURL=index.cjs.js.map
