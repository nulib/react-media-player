var Qn=Object.create;var Ne=Object.defineProperty,Yn=Object.defineProperties,Kn=Object.getOwnPropertyDescriptor,Zn=Object.getOwnPropertyDescriptors,Xn=Object.getOwnPropertyNames,ye=Object.getOwnPropertySymbols,Jn=Object.getPrototypeOf,Le=Object.prototype.hasOwnProperty,bt=Object.prototype.propertyIsEnumerable;var vt=(t,e,r)=>e in t?Ne(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,l=(t,e)=>{for(var r in e||(e={}))Le.call(e,r)&&vt(t,r,e[r]);if(ye)for(var r of ye(e))bt.call(e,r)&&vt(t,r,e[r]);return t},g=(t,e)=>Yn(t,Zn(e));var De=(t,e)=>{var r={};for(var n in t)Le.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&ye)for(var n of ye(t))e.indexOf(n)<0&&bt.call(t,n)&&(r[n]=t[n]);return r};var ei=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ti=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Xn(e))!Le.call(t,i)&&i!==r&&Ne(t,i,{get:()=>e[i],enumerable:!(n=Kn(e,i))||n.enumerable});return t};var ri=(t,e,r)=>(r=t!=null?Qn(Jn(t)):{},ti(e||!t||!t.__esModule?Ne(r,"default",{value:t,enumerable:!0}):r,t));var tr=ei((ve,er)=>{(function(t,e){typeof ve=="object"&&typeof er<"u"?e(ve):typeof define=="function"&&define.amd?define(["exports"],e):e((t=t||self).TypesafeActions={})})(ve,function(t){"use strict";function e(c){return c==null}function r(c){throw new Error("Argument "+c+" is empty.")}function n(c){return typeof c=="function"&&"getType"in c}function i(c){throw new Error("Argument "+c+' is invalid, it should be an action-creator instance from "typesafe-actions"')}function o(c,u){if(c==null)throw new Error("Argument contains array with empty element at index "+u);if(c.getType==null)throw new Error("Argument contains array with invalid element at index "+u+', it should be an action-creator instance from "typesafe-actions"')}function a(c){return typeof c=="string"||typeof c=="symbol"}function s(c){return!a(c)}function d(c){throw new Error("Argument "+c+" is invalid, it should be an action type of type: string | symbol")}function p(c,u){if(c==null)throw new Error("Argument contains array with empty element at index "+u);if(typeof c!="string"&&typeof c!="symbol")throw new Error("Argument contains array with invalid element at index "+u+", it should be of type: string | symbol")}function y(c,u,f,C){return e(c)&&r(1),s(c)&&i(1),{type:c,payload:u,meta:f,error:C}}function b(c,u){return e(c)&&r(1),s(c)&&d(1),Object.assign(function(){var f=u!=null?u.apply(void 0,arguments):void 0;return Object.assign({type:c},f)},{getType:function(){return c},toString:function(){return c}})}function v(c,u,f){return e(c)&&r(1),s(c)&&d(1),function(){return b(c,function(){var C=arguments.length<=0?void 0:arguments[0],A=arguments.length<=1?void 0:arguments[1];return u==null&&f==null||(C=u!=null?u.apply(void 0,arguments):void 0,A=f!=null?f.apply(void 0,arguments):void 0),Object.assign({},C!==void 0&&{payload:C},{},A!==void 0&&{meta:A})})}}function w(c){return e(c)&&r(1),n(c)||i(1),c.getType()}function h(c,u){e(c)&&r(1),s(c)&&d(1);var f=u!=null?u(c):function(){return{type:c}};return Object.assign(f,{getType:function(){return c},toString:function(){return c}})}var x={createAction:function(c,u){var f=u==null?function(){return y(c)}:u(y.bind(null,c));return Object.assign(f,{getType:function(){return c},toString:function(){return c}})},createCustomAction:h,createStandardAction:function(c){return e(c)&&r(1),s(c)&&d(1),Object.assign(function(){return h(c,function(u){return function(f,C){return{type:u,payload:f,meta:C}}})},{map:function(u){return h(c,function(f){return function(C,A){return Object.assign(u(C,A),{type:f})}})}})}};t.action=y,t.createAction=v,t.createAsyncAction=function(c,u,f,C){return function(){var A=[c,u,f,C].map(function(E,F){return Array.isArray(E)?v(E[0],E[1],E[2])():typeof E=="string"||typeof E=="symbol"?v(E)():void(F<3&&function(te){throw new Error("Argument "+te+' is invalid, it should be an action type of "string | symbol" or a tuple of "[string | symbol, Function, Function?]"')}(F))});return{request:A[0],success:A[1],failure:A[2],cancel:A[3]}}},t.createCustomAction=b,t.createReducer=function c(u,f){f===void 0&&(f={});var C=Object.assign({},f),A=function(E,F){var te=Array.isArray(E)?E:[E],yt={};return te.map(function(re,Hn){return n(re)?w(re):a(re)?re:function(Gn){throw new Error("Argument "+Gn+' is invalid, it should be an action-creator instance from "typesafe-actions" or action type of type: string | symbol')}(Hn+1)}).forEach(function(re){return yt[re]=F}),c(u,Object.assign({},C,{},yt))};return Object.assign(function(E,F){if(E===void 0&&(E=u),C.hasOwnProperty(F.type)){var te=C[F.type];if(typeof te!="function")throw Error('Reducer under "'+F.type+'" key is not a valid reducer');return te(E,F)}return E},{handlers:Object.assign({},C),handleAction:A,handleType:A})},t.deprecated=x,t.getType=w,t.isActionOf=function(c,u){e(c)&&r(1);var f=Array.isArray(c)?c:[c];f.forEach(o);var C=function(A){return f.some(function(E){return A.type===E.getType()})};return u===void 0?C:C(u)},t.isOfType=function(c,u){e(c)&&r(1);var f=Array.isArray(c)?c:[c];f.forEach(p);var C=function(A){return f.includes(A.type)};return u===void 0?C:C(u)}})});import W,{useEffect as qn,useState as Ma}from"react";import J from"react";var ni={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]},ii={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],duration:0,height:0,width:0},oi={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],services:[]},ai={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:[],behavior:[],homepage:[],items:[],label:null,logo:[],metadata:[],motivation:null,navDate:null,provider:[],partOf:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,rendering:[],requiredStatement:null,rights:null,seeAlso:[],service:[],services:[],start:null,structures:[],summary:null,thumbnail:[],viewingDirection:"left-to-right"},si={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],start:null,supplementary:null,viewingDirection:"left-to-right"},ci={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:[],seeAlso:[],homepage:[]},Ct=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function li(t){if(typeof t>"u"||t===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(t))throw new Error("Array is not a valid entity");if(typeof t!="object")throw new Error(`${typeof t} is not a valid entity`);if(typeof t.type=="string"){let e=Ct.indexOf(t.type);if(e!==-1)return Ct[e]}if(t.profile)return"Service";throw new Error("Resource type is not known")}var ce=class{traversals;options;constructor(e,r={}){this.traversals=l({collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[]},e),this.options=l({allowUndefinedReturn:!1},r)}static all(e){return new ce({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e]})}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=e.thumbnail.map(r=>this.traverseType(r,this.traversals.contentResource))),e.provider&&(e.provider=e.provider.map(r=>this.traverseAgent(r))),e}traverseLinking(e){return e.seeAlso&&(e.seeAlso=e.seeAlso.map(r=>this.traverseType(r,this.traversals.contentResource))),e.service&&(e.service=e.service.map(r=>this.traverseType(r,this.traversals.service))),e.services&&(e.services=e.services.map(r=>this.traverseType(r,this.traversals.service))),e.logo&&(e.logo=e.logo.map(r=>this.traverseType(r,this.traversals.contentResource))),e.homepage&&(e.homepage=e.homepage.map(r=>this.traverseType(r,this.traversals.contentResource))),e.partOf&&(e.partOf=e.partOf.map(r=>typeof r=="string"||!r.type?this.traverseType(r,this.traversals.contentResource):r.type==="Canvas"?this.traverseType(r,this.traversals.canvas):r.type==="AnnotationCollection"?this.traverseType(r,this.traversals.annotationCollection):this.traverseType(r,this.traversals.contentResource))),e.start&&(e.start=e.start?this.traverseType(e.start,this.traversals.canvas):null),e.rendering&&(e.rendering=e.rendering.map(r=>this.traverseType(r,this.traversals.contentResource))),e.supplementary&&(e.supplementary=e.supplementary.map(r=>this.traverseType(r,this.traversals.contentResource))),e}traverseCollectionItems(e){return e.items&&e.items.map(r=>r.type==="Collection"?this.traverseCollection(r):this.traverseManifest(r)),e}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traversePosterCanvas(this.traverseCollectionItems(e))))),this.traversals.collection)}traverseManifestItems(e){return e.items&&(e.items=e.items.map(r=>this.traverseCanvas(r))),e}traverseManifestStructures(e){return e.structures&&(e.structures=e.structures.map(r=>this.traverseRange(r))),e}traverseManifest(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traverseManifestStructures(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e)))))),this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map(r=>this.traverseAnnotationPage(r)),e}traverseInlineAnnotationPages(e){return typeof e=="string"||!e||e.annotations&&(e.annotations=e.annotations.map(r=>this.traverseAnnotationPage(r))),e}traverseCanvas(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))))),this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&(e.items=e.items.map(r=>this.traverseAnnotation(r))),e}traverseAnnotationPage(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationPageItems(e))),this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map(r=>this.traverseContentResource(r)):e.body&&(e.body=this.traverseContentResource(e.body)),e}traversePosterCanvas(e){return e.posterCanvas&&(e.posterCanvas=this.traverseType(e.posterCanvas,this.traversals.canvas)),e.placeholderCanvas&&(e.placeholderCanvas=this.traverseType(e.placeholderCanvas,this.traversals.canvas)),e.accompanyingCanvas&&(e.accompanyingCanvas=this.traverseType(e.accompanyingCanvas,this.traversals.canvas)),e}traverseAnnotation(e){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(e)),this.traversals.annotation)}traverseContentResourceLinking(e){return typeof e=="string"||!e||e&&e.service&&(e.service=(e.service||[]).map(r=>this.traverseType(r,this.traversals.service))),e}traverseContentResource(e){return e.type==="Choice"&&(e.items=e.items.map(r=>this.traverseContentResource(r))),this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),this.traversals.contentResource)}traverseRangeRanges(e){return e.items&&(e.items=e.items.map(r=>typeof r=="string"?this.traverseCanvas({id:r,type:"Canvas"}):r.type==="Manifest"?this.traverseManifest(r):this.traverseRange(r))),e}traverseRange(e){return this.traverseType(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseRangeRanges(e)))),this.traversals.range)}traverseAgent(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.agent)}traverseType(e,r){return r.reduce((n,i)=>{let o=i(n);return typeof o>"u"&&!this.options.allowUndefinedReturn?n:o},e)}traverseService(e){return this.traverseType(e,this.traversals.service)}traverseUnknown(e){let r=li(e);switch(r){case"Collection":return this.traverseCollection(e);case"Manifest":return this.traverseManifest(e);case"Canvas":return this.traverseCanvas(e);case"AnnotationPage":return this.traverseAnnotationPage(e);case"Annotation":return this.traverseAnnotation(e);case"ContentResource":return this.traverseContentResource(e);case"Range":return this.traverseRange(e);case"Service":return this.traverseService(e);case"Agent":return this.traverseAgent(e);default:throw new Error(`Unknown or unsupported resource type of ${r}`)}}},xt=["sc:Collection","sc:Manifest","sc:Canvas","oa:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function ui(t){if(typeof t>"u"||t===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(t))throw new Error("Array is not a valid entity");if(typeof t!="object")throw new Error(`${typeof t} is not a valid entity`);if(typeof t["@type"]=="string"){let e=xt.indexOf(t["@type"]);if(e!==-1)return xt[e]}if(t.profile)return"Service";if(t.format||t["@type"])return"ContentResource";throw new Error("Resource type is not known")}var le=class{traversals;options;constructor(e,r={}){this.traversals=l({collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[]},e),this.options=l({convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1},r)}static all(e){return new le({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let r=[...(e.manifests||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Manifest"}:n),...(e.collections||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Collection"}:n),...e.members||[]];delete e.collections,delete e.manifests,e.members=r}return e.manifests&&(e.manifests=e.manifests.map(r=>this.traverseManifest(typeof r=="string"?{"@id":r,"@type":"sc:Manifest"}:r))),e.collections&&(e.collections=e.collections.map(r=>this.traverseCollection(typeof r=="string"?{"@id":r,"@type":"sc:Collection"}:r))),e.members&&(e.members=e.members.map(r=>typeof r=="string"?r:this.traverseUnknown(r))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(r=>this.traverseSequence(r))),e.structures&&(e.structures=e.structures.map(r=>this.traverseRange(r))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(r=>this.traverseCanvas(r))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(r=>this.traverseAnnotation(r))),e.otherContent&&(e.otherContent=e.otherContent.map(r=>this.traverseAnnotationList(r))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let r=[...(e.ranges||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Range"}:n),...(e.canvases||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Canvas"}:n),...e.members||[]];delete e.ranges,delete e.canvases,e.members=r.length?r.map(n=>this.traverseUnknown(n)):void 0}return e}traverseAnnotationList(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationListItems(e))),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(r=>this.traverseAnnotation(r))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(r=>this.traverseAnnotationList(r))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(r=>this.traverseContentResource(r))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(ui(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"oa:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let r=Array.isArray(e),n=Array.isArray(e)?e:[e],i=[];for(let o of n)typeof o=="string"?i.push(this.traverseContentResource({"@id":o,"@type":"dctypes:Image"})):i.push(this.traverseContentResource(o));return!r&&!this.options.convertPropsToArray?i[0]:i}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let r=Array.isArray(e),n=Array.isArray(e)?e:[e],i=[];for(let o of n)i.push(this.traverseService(o));return!r&&!this.options.convertPropsToArray?i[0]:i}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,r){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,r);return e.map(n=>this.traverseType(n,r))}traverseType(e,r){return r.reduce((n,i)=>{let o=i(n);return typeof o>"u"&&!this.options.allowUndefinedReturn?n:o},e)}},di="http://library.stanford.edu/iiif/image-api/compliance.html#level0",At="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Et="http://library.stanford.edu/iiif/image-api/compliance.html#level2",pi="http://library.stanford.edu/iiif/image-api/conformance.html#level0",St="http://library.stanford.edu/iiif/image-api/conformance.html#level1",Tt="http://library.stanford.edu/iiif/image-api/conformance.html#level2",fi="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",Rt="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",Ot="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",mi="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",kt="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",Mt="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",hi="http://iiif.io/api/image/1/level0.json",gi="http://iiif.io/api/image/1/profiles/level0.json",Pt="http://iiif.io/api/image/1/level1.json",Nt="http://iiif.io/api/image/1/profiles/level1.json",Lt="http://iiif.io/api/image/1/level2.json",Dt="http://iiif.io/api/image/1/profiles/level2.json",yi="http://iiif.io/api/image/2/level0.json",vi="http://iiif.io/api/image/2/profiles/level0.json",Ft="http://iiif.io/api/image/2/level1.json",Vt="http://iiif.io/api/image/2/profiles/level1.json",$t="http://iiif.io/api/image/2/level2.json",jt="http://iiif.io/api/image/2/profiles/level2.json",bi="level0",Wt="level1",_t="level2",Ci="http://iiif.io/api/image/2/level0",zt="http://iiif.io/api/image/2/level1",Bt="http://iiif.io/api/image/2/level2",xi=[zt,Bt,At,Et,St,Tt,Rt,Ot,kt,Mt,Pt,Nt,Lt,Dt,Ft,Vt,$t,jt,Wt,_t],wi=[Ci,zt,Bt,di,At,Et,pi,St,Tt,fi,Rt,Ot,mi,kt,Mt,hi,gi,Pt,Nt,Lt,Dt,yi,vi,Ft,Vt,$t,jt,bi,Wt,_t],Ve={attributionLabel:"Attribution",lang:"none",providerId:"http://example.org/provider",providerName:"Unknown"};function X(t,e="none"){if(!t)return{};let r=Array.isArray(t)?t:[t],n={};for(let i of r){if(typeof i=="string"){n[e]=n[e]?n[e]:[],n[e].push(i||"");continue}if(!i["@language"]){n[e]=n[e]?n[e]:[],n[e].push(i["@value"]||"");continue}let o=i["@language"];n[o]=n[o]?n[o]:[],n[o].push(i["@value"]||"")}return n}function Ut(t){if(Array.isArray(t))return Ut(t.find(e=>typeof e=="string"));if(wi.indexOf(t)!==-1)return"level2";if(xi.indexOf(t)!==-1)return"level1";if(typeof t=="string")return t}function Ii(t){let e=Array.isArray(t)?t:[t];for(let r of e)switch(r){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function Ai(t){switch(t){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function Ei(t){return Array.isArray(t)?t:[t]}function Si(t){for(let e of["sc","oa","dcterms","dctypes","iiif"])if(t.startsWith(`${e}:`))return t.slice(e.length+1);return t}var Ti=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function $e(t){let e=t["@id"]||t.id,r=t["@type"]||t.type,n=t.profile||void 0,i=t["@context"]||void 0;if(n){let o=Ai(n);if(o)return o}if(i){let o=Ii(i);if(o)return o}if(r){if(Array.isArray(r)){if(r.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(r.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";r=r[0]}for(let o of["sc","oa","dcterms","dctypes","iiif"])if(r.startsWith(`${o}:`)){r=r.slice(o.length+1);break}switch(r){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(r&&Ti.indexOf(r)!==-1)return r;if(t.format){if(t.format.startsWith("image/"))return"Image";if(t.format.startsWith("text/")||t.format==="application/pdf")return"Text";if(t.format.startsWith("application/"))return"Dataset"}return e&&(e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".jpeg"))?"Image":r||"unknown"}var Ri=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function Oi(t){let e=t.match(Ri);return e?e[0]:t}function ki(t,e="Rights/License",r="none"){let n=null,i=[],o=Array.isArray(t)?t:[t];for(let a of o){let s=a?Oi(a):void 0;if(s&&(s.indexOf("creativecommons.org")!==-1||s.indexOf("rightsstatements.org")!==-1)){s.startsWith("https://")?n=`http://${s.slice(8)}`:n=s;continue}s&&i.push({label:{[r]:[e]},value:{[r]:[s]}})}return[n,i]}var Mi=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function Pi(t){if(t){let e=Array.isArray(t)?t:[t],r=[];for(let n of e)n==="http://iiif.io/api/presentation/2/context.json"&&r.push("http://iiif.io/api/presentation/3/context.json"),Mi.indexOf(n)===-1&&r.push(n);if(e.length)return r.length===1?r[0]:r}}function Ni(t){return t?t.map(e=>({label:X(e.label),value:X(e.value)})):[]}function V(t){for(let e in t)(typeof t[e]>"u"||t[e]===null)&&delete t[e];return t}var wt=0;function qt(t,e){let r=encodeURI(t.id||t["@id"]||"").trim();return r&&e?`${r}/${e}`:r||(wt++,`http://example.org/${t["@type"]}${e?`/${e}`:""}/${wt}`)}function $(t){let e=[...t.behavior||[]];return t.viewingHint&&e.push(t.viewingHint),{"@context":t["@context"]?Pi(t["@context"]):void 0,id:(t["@id"]||qt(t)).trim(),type:$e(t),behavior:e.length?e:void 0,height:t.height?t.height:void 0,width:t.width?t.width:void 0,motivation:t.motivation?Si(t.motivation):void 0,viewingDirection:t.viewingDirection,profile:t.profile,format:t.format?t.format:void 0,duration:void 0,timeMode:void 0}}function L(t){let[e,r]=ki(t.license),n=[...t.metadata?Ni(t.metadata):[],...r];return{rights:e,metadata:n.length?n:void 0,label:t.label?X(t.label):void 0,requiredStatement:t.attribution?{label:X(Ve.attributionLabel),value:X(t.attribution)}:void 0,navDate:t.navDate,summary:t.description?X(t.description):void 0,thumbnail:t.thumbnail}}function Li(t){if(!t.within)return;let e=Array.isArray(t.within)?t.within:[t.within],r=[];for(let n of e)if(typeof n=="string"){if(n)switch(t["@type"]){case"sc:Manifest":r.push({id:n,type:"Collection"});break}}else n["@id"]&&r.push({id:n["@id"],type:$e(n)});return r.length?r:void 0}function z(t){let e=t.related?Array.isArray(t.related)?t.related:[t.related]:[],r=t.contentLayer;return{provider:t.logo||e.length?[{id:Ve.providerId,type:"Agent",homepage:e.length?[e[0]]:void 0,logo:t.logo?Array.isArray(t.logo)?t.logo:[t.logo]:void 0,label:X(Ve.providerName)}]:void 0,partOf:Li(t),rendering:t.rendering,seeAlso:t.seeAlso,start:t.startCanvas,service:t.service?Ei(t.service):void 0,supplementary:r?[r]:void 0}}function Di(t){return V(g(l(l(l({},$(t)),L(t)),z(t)),{items:t.members}))}function Fi(t){let e=[],r=[];for(let i of t.sequences||[])i.canvases.length&&e.push(...i.canvases),i.behavior&&r.push(...i.behavior);let n=$(t);return r.length&&(n.behavior?n.behavior.push(...r):n.behavior=r),V(g(l(l(l({},n),L(t)),z(t)),{items:e,structures:t.structures}))}function Vi(t){return V(g(l(l(l({},$(t)),L(t)),z(t)),{items:t.images&&t.images.length?[{id:qt(t,"annotation-page"),type:"AnnotationPage",items:t.images}]:void 0}))}function $i(t){return V(g(l(l(l({},$(t)),L(t)),z(t)),{items:t.resources}))}function ji(t){return!t.canvases||t.canvases.length===0?{canvases:[],behavior:[]}:{canvases:t.canvases,behavior:t.viewingHint?[t.viewingHint]:[]}}function Wi(t){return V(g(l(l(l({},$(t)),L(t)),z(t)),{target:typeof t.on=="string"?encodeURI(t.on).trim():t.on,body:t.resource}))}function _i(t){let e=t;return V(l(l(l({},$(e)),L(e)),z(e)))}function zi(t){let e=[];return t.default&&t.default!=="rdf:nil"&&e.push(t.default),t.item&&t.item!=="rdf:nil"&&e.push(...t.item),g(l(l({},$(t)),L(t)),{items:e})}function Bi(t){return V(g(l(l(l({},$(t)),L(t)),z(t)),{items:t.members}))}function Ui(t){let a=t,{"@id":e,"@type":r,"@context":n,profile:i}=a,o=De(a,["@id","@type","@context","profile"]);return e&&(o.id=e),o.type=$e(t),o.type==="unknown"&&(o.type="Service"),i&&(o.profile=Ut(i)),V(l(l({},o),L(o)))}function qi(t){return V(l(l(l({},$(t)),L(t)),z(t)))}var Hi=new le({collection:[Di],manifest:[Fi],canvas:[Vi],annotationList:[$i],sequence:[ji],annotation:[Wi],contentResource:[_i],choice:[zi],range:[Bi],service:[Ui],layer:[qi]});function Gi(t){return t&&t["@context"]&&(t["@context"]==="http://iiif.io/api/presentation/2/context.json"||t["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||t["@context"]==="http://www.shared-canvas.org/ns/context.json")||t["@context"]==="http://iiif.io/api/image/2/context.json"?Hi.traverseUnknown(t):t}function Qi(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function Ht(t,e){if(typeof t=="string")return{id:t,type:e};if(!t.id)throw new Error(`Invalid resource does not have an ID (${e})`);return t}function Yi(t){return(e,r)=>{let n=t[e]?t[e]:{};return i=>{let o=Ht(i,r||e);return o&&o.id&&e?(n[o.id]=n[o.id]?Object.assign({},n[o.id],o):Object.assign({},o),{id:o.id,type:e==="ContentResource"?e:o.type}):o}}}function Ki(t){return(e,r)=>n=>{let{id:i,type:o}=Ht(n,r||e);if(typeof i>"u")throw new Error("Found invalid entity without an ID.");return e==="ContentResource"?t[i]=e:t[i]=o,n}}function Zi(t){let e=JSON.stringify(t),r=5381,n=e.length;for(;n;)r=r*33^e.charCodeAt(--n);let i=(r>>>0).toString(16);return i.length%2?"0"+i:i}function Fe(t){return e=>typeof e=="string"?{id:e,type:t}:e.id?e.type?e:l({type:t},e):l({id:Zi(e),type:t},e)}function ne(t){return e=>l(l({},t),e)}function ie(t){return Array.isArray(t)?t:[t]}function Xi(t){return t.body&&(t.body=ie(t.body)),t.seeAlso&&(t.seeAlso=ie(t.seeAlso)),t.body&&(t.body=ie(t.body)),t.audience&&(t.audience=ie(t.audience)),t.accessibility&&(t.accessibility=ie(t.accessibility)),t.motivation&&(t.motivation=ie(t.motivation)),t}function Gt(t){let e=Gi(t),r=Qi(),n={},i=Yi(r),o=Ki(n),a=new ce({collection:[ne(oi),o("Collection"),i("Collection")],manifest:[ne(ai),o("Manifest"),i("Manifest")],canvas:[ne(ii),o("Canvas"),i("Canvas")],annotationPage:[Fe("AnnotationPage"),ne(ni),o("AnnotationPage"),i("AnnotationPage")],annotation:[Fe("Annotation"),Xi,o("Annotation"),i("Annotation")],contentResource:[Fe("ContentResource"),o("ContentResource"),i("ContentResource")],range:[ne(si),o("Range","Canvas"),i("Range","Canvas")],agent:[ne(ci),o("Agent"),i("Agent")]}).traverseUnknown(e);return{entities:r,resource:a,mapping:n}}var Z="__$UNSET$__",Qt="__$UNWRAP$__";function Ji(t,e){let r=t.requests[e],n=t.mapping[e];if(!(!n||r&&r.resourceUri&&!t.entities[n][r.resourceUri]))return t.entities[n][r?r.resourceUri:e]}function eo(t){let e={};for(let[r,n]of t){if(r===Qt&&n!==Z)return n;n!==Z&&typeof n<"u"&&n!==null&&(e[r]=n)}return e}function Yt(t,e,r){if(!e.type||!e.id)throw new Error("Unknown entity");if(!r[e.type])throw new Error(`Serializer not found for ${e.type}`);function n(i){let o=r[i.type];if(!o)return Z;let a=Ji(t,i.id)||(i.id&&i.type?i:null);if(!a)return Z;let s=o(a,t,{isTopLevel:e.id===i.id}),d=s.next();for(;!d.done;){let p=d.value,y=Z;if(p)if(Array.isArray(p)){let b=[];for(let v of p)b.push(n(v));y=b}else y=n(p);d=s.next(y)}return d.value===Z?Z:eo(d.value)}return n(e)}function oe(t){if(!t)return;let e=Object.keys(t);if(e.length!==0){if(e.length===1){let r=e[0];if(!r)return"";let n=(t[r]||[]).join("");return r==="@none"||r==="none"||r==="en"?n:{"@language":r,"@value":n}}return e.map(r=>({"@language":r,"@value":(t[r]||[]).join("")}))}}function Kt(t){return Array.isArray(t)?t.map(e=>Kt(e)):typeof t=="string"?t:t.type&&t.type==="Canvas"?t.id:t}function _(t,e=!1){if(t)return t.length>1&&!e?t:t[0]||void 0}function to(t){if(t){if(typeof t=="string")return{"@id":t};if("@id"in t){let e=l({},t);return delete e["@type"],e}return{"@context":"http://iiif.io/api/image/2/context.json","@id":t.id,profile:`http://iiif.io/api/image/2/profiles/${t.profile}.json`}}}function H(t,e){return[["@id",t.id],["@type",e],["format",t.format],["height",t.height],["width",t.width],["viewingDirection",t.viewingDirection!=="left-to-right"?t.viewingDirection:void 0]]}function*G(t){let e=t.provider?yield t.provider[0]:void 0;return[["label",oe(t.label)],["metadata",t.metadata&&t.metadata.length?t.metadata.map(r=>({label:oe(r.label)||"",value:oe(r.value)||""})):void 0],["description",oe(t.summary)],["thumbnail",_(yield t.thumbnail)],["navDate",t.navDate],["logo",e?_(e.logo):void 0],["homepage",e?e.homepage:void 0],["attribution",t.requiredStatement?oe(t.requiredStatement.value):void 0]]}function*se(t){return[["seeAlso",_(yield t.seeAlso)],["service",_((t.service||[]).map(to))],["rendering",_(yield t.rendering)],["startCanvas",t.start?t.start.id:void 0]]}var Zt={Manifest:function*(t){return[...H(t,"sc:Manifest"),...yield*G(t),...yield*se(t),["sequences",[{"@id":`${t.id}/sequence0`,"@type":"sc:Sequence",canvases:yield t.items}]],["structures",yield t.structures]]},Canvas:function*(t){let e=(yield t.items)[0];return[...H(t,"sc:Canvas"),...yield*G(t),...yield*se(t),["images",e?[e.resources]:void 0],["annotations",t.annotations&&t.annotations.length?_(yield t.annotations):void 0]]},AnnotationPage:function*(t){return[...H(t,"sc:AnnotationList"),...yield*G(t),["resources",t.items&&t.items.length?_(yield t.items):void 0]]},Annotation:function*(t){return[["@id",t.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",Kt(t.target)],["resource",_(yield t.body,!0)]]},ContentResource:function*(t){switch(t.type){case"Image":return[...H(t,"dctypes:Image"),...yield*G(t),...yield*se(t)];case"Text":case"Dataset":default:return[...H(t,void 0),...yield*G(t)]}},AnnotationCollection:function*(t){return[["@id",t.id],["@type","sc:Layer"],["label",oe(t.label)]]},Collection:function*(t){return[...H(t,"sc:Collection"),...yield*G(t),...yield*se(t),["members",yield*t.items]]},Range:function*(t){let e=[],r=[];if(t.items)for(let n of t.items){let i=yield n;e.push({"@id":n.id,"@type":n.type,label:i?i.label:void 0,within:t.id}),n.type==="Canvas"&&r.push(n.id)}return[...H(t,"sc:Range"),...yield*G(t),...yield*se(t),["canvases",r.length===e.length?r:void 0],["members",r.length!==e.length?e:void 0]]}};function Q(t){return[["id",t.id],["type",t.type],["format",t.format],["profile",t.profile],["height",t.height],["width",t.width],["duration",t.duration||void 0],["viewingDirection",t.viewingDirection!=="left-to-right"?t.viewingDirection:void 0],["behavior",t.behavior&&t.behavior.length?t.behavior:void 0],["timeMode",t.timeMode],["motivation",t.motivation]]}function T(t){if(!(!t||t.length===0))return t}function Xt(t){if(t&&t.type&&t.type==="ImageService2"){let e=t,{id:r,type:n,profile:i}=e,o=De(e,["id","type","profile"]);return l({"@id":r,"@type":n,profile:i.startsWith("http")?i:`http://iiif.io/api/image/2/${i}.json`},o)}return t}function It(t){if(!(!t||t.length===0))return t.map(Xt)}function*Y(t){return[["label",t.label],["metadata",T(t.metadata)],["summary",t.summary],["requiredStatement",t.requiredStatement],["rights",t.rights],["navDate",t.navDate],["language",t.language],["thumbnail",T(yield t.thumbnail)],["placeholderCanvas",yield t.placeholderCanvas],["accompanyingCanvas",yield t.accompanyingCanvas],["provider",T(yield t.provider)]]}function*K(t){return[["seeAlso",T(yield t.seeAlso)],["service",It(t.service)],["services",It(t.services)],["rendering",T(yield t.rendering)],["supplementary",T(yield t.supplementary)],["homepage",T(yield t.homepage)],["logo",T(yield t.logo)],["partOf",T(yield t.partOf)],["start",t.start]]}var Jt={Manifest:function*(t,e,{isTopLevel:r}){return r?[["@context","http://iiif.io/api/presentation/3/context.json"],...Q(t),...yield*Y(t),...yield*K(t),["items",yield t.items],["structures",T(yield t.structures)],["annotations",T(yield t.annotations)]]:[...Q(t),...yield*Y(t)]},Canvas:function*(t){return[...Q(t),...yield*Y(t),...yield*K(t),["items",yield t.items],["annotations",T(yield t.annotations)]]},Agent:function*(t){return[["id",t.id],["type","Agent"],["label",t.label],...yield*K(t)]},AnnotationPage:function*(t){return[...Object.entries(t).map(([e,r])=>[e,Array.isArray(r)?T(r):r]).filter(([e,r])=>e!=="items"),...yield*K(t),["items",yield t.items]]},Service:function*(t){return[[Qt,Xt(t)]]},Annotation:function*(t){return[...Object.entries(t).map(([e,r])=>[e,Array.isArray(r)?T(r):r]).filter(([e])=>e!=="body"),["body",yield t.body]]},ContentResource:function*(t){return[...Q(t),...yield*Y(t),...yield*K(t),["annotations",T(yield t.annotations)]]},AnnotationCollection:function*(t){return[["id",t.id],["type","AnnotationCollection"],["label",t.label]]},Collection:function*(t,e,{isTopLevel:r}){return r?[["@context","http://iiif.io/api/presentation/3/context.json"],...Q(t),...yield*Y(t),...yield*K(t),["items",T(yield t.items)]]:[...Q(t),...yield*Y(t)]},Range:function*(t){let e=[];for(let r of t.items)r.type==="Range"?e.push(yield r):e.push(r);return[...Q(t),...yield*Y(t),...yield*K(t),["items",e],["annotations",T(yield t.annotations)]]}};var S=ri(tr(),1);function je(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function be(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rr(Object(r),!0).forEach(function(n){je(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function R(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var nr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),We=function(){return Math.random().toString(36).substring(7).split("").join(".")},Ce={INIT:"@@redux/INIT"+We(),REPLACE:"@@redux/REPLACE"+We(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+We()}};function ro(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function _e(t,e,r){var n;if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(R(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(R(1));return r(_e)(t,e)}if(typeof t!="function")throw new Error(R(2));var i=t,o=e,a=[],s=a,d=!1;function p(){s===a&&(s=a.slice())}function y(){if(d)throw new Error(R(3));return o}function b(x){if(typeof x!="function")throw new Error(R(4));if(d)throw new Error(R(5));var c=!0;return p(),s.push(x),function(){if(!!c){if(d)throw new Error(R(6));c=!1,p();var f=s.indexOf(x);s.splice(f,1),a=null}}}function v(x){if(!ro(x))throw new Error(R(7));if(typeof x.type>"u")throw new Error(R(8));if(d)throw new Error(R(9));try{d=!0,o=i(o,x)}finally{d=!1}for(var c=a=s,u=0;u<c.length;u++){var f=c[u];f()}return x}function w(x){if(typeof x!="function")throw new Error(R(10));i=x,v({type:Ce.REPLACE})}function h(){var x,c=b;return x={subscribe:function(f){if(typeof f!="object"||f===null)throw new Error(R(11));function C(){f.next&&f.next(y())}C();var A=c(C);return{unsubscribe:A}}},x[nr]=function(){return this},x}return v({type:Ce.INIT}),n={dispatch:v,subscribe:b,getState:y,replaceReducer:w},n[nr]=h,n}function no(t){Object.keys(t).forEach(function(e){var r=t[e],n=r(void 0,{type:Ce.INIT});if(typeof n>"u")throw new Error(R(12));if(typeof r(void 0,{type:Ce.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(R(13))})}function ze(t){for(var e=Object.keys(t),r={},n=0;n<e.length;n++){var i=e[n];typeof t[i]=="function"&&(r[i]=t[i])}var o=Object.keys(r),a,s;try{no(r)}catch(d){s=d}return function(p,y){if(p===void 0&&(p={}),s)throw s;if(!1)var b;for(var v=!1,w={},h=0;h<o.length;h++){var x=o[h],c=r[x],u=p[x],f=c(u,y);if(typeof f>"u"){var C=y&&y.type;throw new Error(R(14))}w[x]=f,v=v||f!==u}return v=v||o.length!==Object.keys(p).length,v?w:p}}function ue(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===0?function(n){return n}:e.length===1?e[0]:e.reduce(function(n,i){return function(){return n(i.apply(void 0,arguments))}})}function Be(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(n){return function(){var i=n.apply(void 0,arguments),o=function(){throw new Error(R(15))},a={getState:i.getState,dispatch:function(){return o.apply(void 0,arguments)}},s=e.map(function(d){return d(a)});return o=ue.apply(void 0,s)(i.dispatch),be(be({},i),{},{dispatch:o})}}}var cr="@iiif/IMPORT_ENTITIES",lr="@iiif/MODIFY_ENTITY_FIELD",ur="@iiif/REORDER_ENTITY_FIELD",dr="@iiif/ADD_REFERENCE",pr="@iiif/REMOVE_REFERENCE",fr=(0,S.createAction)(cr)(),io=(0,S.createAction)(lr)(),oo=(0,S.createAction)(ur)(),ao=(0,S.createAction)(dr)(),so=(0,S.createAction)(pr)(),co={importEntities:fr,modifyEntityField:io,reorderEntityField:oo,addReference:ao,removeReference:so},mr="@iiif/ADD_MAPPING",hr="@iiif/ADD_MAPPINGS",lo=(0,S.createAction)(mr)(),uo=(0,S.createAction)(hr)(),gr="@iiif/SET_META_VALUE",yr="@iiif/SET_META_VALUE_DYNAMIC",vr="@iiif/UNSET_META_VALUE",po=(0,S.createAction)(gr)(),fo=(0,S.createAction)(yr)(),mo=(0,S.createAction)(vr)(),ir={setMetaValue:po,setMetaValueDynamic:fo,unsetMetaValue:mo},He="RESOURCE_ERROR",br="RESOURCE_LOADING",Ge="RESOURCE_READY",Cr="@iiif/REQUEST_RESOURCE",xr="@iiif/REQUEST_ERROR",wr="@iiif/REQUEST_MISMATCH",Ir="@iiif/REQUEST_COMPLETE",Ar="@iiif/REQUEST_OFFLINE_RESOURCE",ho=(0,S.createAction)(Cr)(),Er=(0,S.createAction)(xr)(),go=(0,S.createAction)(wr)(),yo=(0,S.createAction)(Ir)();(0,S.createAction)(Ar)();var Ye="@iiif/BATCH",Sr="@iiif/BATCH_IMPORT",Qe=(0,S.createAction)(Ye)();(0,S.createAction)(Sr)();var vo=(t,e)=>{let{entities:r,resource:n,mapping:i}=Gt(e);if(n.id===void 0)return[Er({id:t,message:"ID is not defined in resource."})];let o=[fr({entities:r}),uo({mapping:i})];return n.id!==t&&(o.push(lo({id:t,type:n.type})),o.push(go({requestId:t,actualId:n.id}))),o.push(yo({id:t})),o},or=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function bo(t,e){return!!(t===e||or(t)&&or(e))}function ar(t,e){if(!Array.isArray(t)||!Array.isArray(e))return t===e;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!bo(t[r],e[r]))return!1;return!0}function Ue(t,e){let r=t.iiif.requests[e],n=t.iiif.mapping[e];if(!(!n||!t.iiif.entities[n][r.resourceUri]))return t.iiif.entities[n][r.resourceUri]}function sr(t,e,{waitTimeout:r=30}={}){return async(n,i)=>{let o=t.getState(),a=o.iiif.requests[n];if(a)switch(a.loadingState){case He:break;case br:{let s,d=!1;try{let p=await Promise.race([new Promise((y,b)=>{d||(s=t.subscribe(()=>{let v=t.getState();if(v.iiif.requests[n].loadingState===He){b();return}if(v.iiif.requests[n].loadingState===Ge){let w=Ue(v,n);w?y(w):b()}}))}),new Promise((y,b)=>setTimeout(()=>{d=!0,b()},r*60))]);if(s&&s(),p)return p}catch{s&&s();break}break}case Ge:{let s=Ue(o,n);if(s)return s;break}}t.dispatch(ho({id:n}));try{let s=await e(n,i);!s.id&&!s["@id"]&&(s["@type"]&&(s["@id"]=n),s.id=n);let d=vo(n,s);return t.dispatch(Qe({actions:d})),Ue(t.getState(),n)}catch(s){throw t.dispatch(Er({id:n,message:s.toString()})),s}}}function Co(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}var xo=(t={},e)=>{switch(e.type){case mr:return g(l({},t),{[e.payload.id]:e.payload.type});case hr:return l(l({},t),e.payload.mapping);default:return t}};function qe(t,e,r,n){return!(!t[r]||!t[r][e]||!t[r][e][n]||!Array.isArray(t[r][e][n]))}var wo=(t=Co(),e)=>{var r;switch(e.type){case lr:{if(!t[e.payload.type]||!t[e.payload.type][e.payload.id])return t;let n=t[e.payload.type][e.payload.id];return typeof n=="string"?t:g(l({},t),{[e.payload.type]:g(l({},t[e.payload.type]),{[e.payload.id]:g(l({},n),{[e.payload.key]:e.payload.value})})})}case ur:{if(!qe(t,e.payload.id,e.payload.type,e.payload.key))return t;let n=t[e.payload.type][e.payload.id];if(typeof n=="string")return t;let i=Array.from(n[e.payload.key]),[o]=i.splice(e.payload.startIndex,1);return i.splice(e.payload.endIndex,0,o),g(l({},t),{[e.payload.type]:g(l({},t[e.payload.type]),{[e.payload.id]:g(l({},n),{[e.payload.key]:i})})})}case cr:{let n=Object.keys(e.payload.entities),i=l({},t);for(let o of n)i[o]=l(l({},t[o]||{}),e.payload.entities[o]||{});return i}case dr:{if(!qe(t,e.payload.id,e.payload.type,e.payload.key))return t;let n=t[e.payload.type][e.payload.id],i=Array.from(n[e.payload.key]);return i.splice(e.payload.index||i.length+1,0,e.payload.reference),g(l({},t),{[e.payload.type]:g(l({},t[e.payload.type]),{[e.payload.id]:g(l({},n),{[e.payload.key]:i})})})}case pr:{if(!qe(t,e.payload.id,e.payload.type,e.payload.key))return t;let n=t[e.payload.type][e.payload.id],i=Array.from(n[e.payload.key]),o=e.payload.index||i.findIndex(a=>a&&a.id===e.payload.reference.id);return o===-1||((r=i[o])==null?void 0:r.id)!==e.payload.reference.id?t:(i.splice(o,1),g(l({},t),{[e.payload.type]:g(l({},t[e.payload.type]),{[e.payload.id]:g(l({},n),{[e.payload.key]:i})})}))}default:return t}},Io=(t={},e)=>{switch(e.type){case Cr:case Ar:return g(l({},t),{[e.payload.id]:{requestUri:e.payload.id,loadingState:br,uriMismatch:!1,resourceUri:e.payload.id}});case wr:return g(l({},t),{[e.payload.requestId]:g(l({},t[e.payload.requestId]||{}),{uriMismatch:!0,resourceUri:e.payload.actualId}),[e.payload.actualId]:{requestUri:e.payload.requestId,loadingState:t[e.payload.requestId].loadingState,uriMismatch:!0,resourceUri:e.payload.actualId}});case xr:return g(l({},t),{[e.payload.id]:g(l({},t[e.payload.id]||{}),{loadingState:He,error:e.payload.message})});case Ir:return g(l({},t),{[e.payload.id]:g(l({},t[e.payload.id]||{}),{loadingState:Ge,error:void 0})})}return t},Ao=(t={},e)=>{let{id:r,updateValue:n,value:i,meta:o,key:a}=e&&e.payload||{};switch(e.type){case gr:return g(l({},t),{[r]:g(l({},t[r]||{}),{[o]:g(l({},t[r]?t[r][o]||{}:{}),{[a]:i})})});case yr:return g(l({},t),{[r]:g(l({},t[r]||{}),{[o]:g(l({},t[r]?t[r][o]||{}:{}),{[a]:t[r]&&t[r][o]?n(t[r][o][a]):n(void 0)})})});case vr:return t[r]&&t[r][o]&&t[r][o][a]?g(l({},t),{[r]:g(l({},t[r]||{}),{[o]:g(l({},t[r]?t[r][o]||{}:{}),{[a]:void 0})})}):t;default:return t}};function Eo(t){return(e,r)=>r&&r.type===Ye?r.payload.actions.reduce(t,e):r&&r.type===Sr?r.payload.state:t(e,r)}var So=ze({mapping:xo,entities:wo,requests:Io,meta:Ao}),To=typeof window<"u"?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ue:ue;function Ro(t={}){let{enableDevtools:e=!0,iiifStoreName:r="iiif",defaultState:n={},extraMiddleware:i=[],customReducers:o={}}=t,a=ze(l({[r]:So},o));return _e(Eo(a),n,e?To(Be(...i)):ue(Be(...i)))}function Oo(t){return{all:t=t||new Map,on:function(e,r){var n=t.get(e);n?n.push(r):t.set(e,[r])},off:function(e,r){var n=t.get(e);n&&(r?n.splice(n.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var n=t.get(e);n&&n.slice().map(function(i){i(r)}),(n=t.get("*"))&&n.slice().map(function(i){i(e,r)})}}}var xe=class{options;store;emitter;isBatching=!1;batchQueue=[];remoteFetcher;staticFetcher;constructor(e,r){this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=r||Ro({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=Oo(),this.remoteFetcher=sr(this.store,this.options.customFetcher),this.staticFetcher=sr(this.store,(n,i)=>i)}defaultFetcher=e=>fetch(e).then(r=>r.json());batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(Qe({actions:this.batchQueue}))}catch(r){throw this.batchQueue=[],this.isBatching=!1,r}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(Qe({actions:this.batchQueue}))}catch(r){throw this.batchQueue=[],this.isBatching=!1,r}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,r,n){this.dispatch(co.modifyEntityField({id:e.id,type:e.type,key:r,value:n}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}middleware=e=>r=>n=>{if(n.type===Ye){for(let a of n.payload.actions)this.emitter.emit(a.type,{realAction:a,state:e.getState()});let o=r(n);for(let a of n.payload.actions)this.emitter.emit(`after:${n.type}`,{action:n,state:o});return o}this.emitter.emit(n.type,{action:n,state:e.getState()});let i=r(n);return this.emitter.emit(`after:${n.type}`,{action:n,state:i}),i};serialize(e,r){return Yt(this.getState().iiif,e,r)}toPresentation2(e){return this.serialize(e,Zt)}toPresentation3(e){return this.serialize(e,Jt)}hydrate(e,r){return this.get(e,r,{skipSelfReturn:!1})}get(e,r,n={}){typeof r!="string"&&(n=r||{},r=void 0);let{skipSelfReturn:i=!0}=n||{};if(Array.isArray(e))return e.map(p=>this.get(p,n));let o=this.getState();if(typeof e=="string"){let p=r||o.iiif.mapping[e];if(!p)return i?null:{id:e,type:"unknown"};e={id:e,type:p}}let a=r||e.type,s=e.id,d=o.iiif.entities[a];if(!d){let p=o.iiif.requests[s];return p&&p.resourceUri!==s?this.get(p.resourceUri,n):i?null:e}return d[e.id]||(i?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,r){let n=typeof e=="string"?e:e.id;return this.load(n,r)}loadCollection(e,r){let n=typeof e=="string"?e:e.id;return this.load(n,r)}load(e,r){let n=typeof e=="string"?e:e.id;return r?this.staticFetcher(n,r):this.remoteFetcher(n)}areInputsEqual(e,r){return ar(e,r)}subscribe(e,r,n){typeof n>"u"&&(typeof r>"u"||r===!1||r===!0)&&(n=r,r=e,e=o=>o);let i=n?null:e(this.store.getState());return n||r(i,this),this.store.subscribe(()=>{let o=this.store.getState(),a=e(o);ar(i,a)||r(a,this),i=a})}async ensureLoaded(e){let r=typeof e=="string"?e:e.id;this.requestStatus(r)||await this.load(r)}requestStatus(e){return this.select(r=>r.iiif.requests[e])}getResourceMeta(e,r){let n=this.getState().iiif.meta[e];if(!!n)return r?n[r]:n}setMetaValue([e,r,n],i){this.dispatch(typeof i=="function"?ir.setMetaValueDynamic({id:e,meta:r,key:n,updateValue:i}):ir.setMetaValue({id:e,meta:r,key:n,value:i}))}};var Tr={showTitle:!0,showIIIFBadge:!0,ignoreCaptionLabels:[]},Ke={activeCanvas:"",configOptions:Tr,isLoaded:!1,vault:new xe},Rr=J.createContext(Ke),Or=J.createContext(Ke);function ko(t,e){switch(e.type){case"updateActiveCanvas":return e.canvasId||(e.canvasId=""),g(l({},t),{activeCanvas:e.canvasId});case"updateConfigOptions":return g(l({},t),{configOptions:l(l({},Tr),e.configOptions)});case"updateIsLoaded":return g(l({},t),{isLoaded:e.isLoaded});default:throw new Error(`Unhandled action type: ${e.type}`)}}var kr=({initialState:t=Ke,children:e})=>{let[r,n]=J.useReducer(ko,t);return J.createElement(Rr.Provider,{value:r},J.createElement(Or.Provider,{value:n},e))};function D(){let t=J.useContext(Rr);if(t===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return t}function we(){let t=J.useContext(Or);if(t===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return t}import he,{useEffect as gt,useState as ge}from"react";function Mr(t){return t.service?`${t.service[0].id}/full/,${t.height||500}/0/default.jpg`:t.id}var Ze=t=>{if(!!t)try{let e=t.thumbnail;return e&&e.length>0?Mr(e[0]):Mr(t.items[0].items[0].body)}catch(e){console.error("Error retrieving accompanying canvas image",e);return}};var ee=(t,e,r,n)=>{var a,s;let i={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},o=d=>{if(d){if(!d.body||!d.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",d);return}if(!d.body)return;let p=d.body;Array.isArray(p)&&(p=p[0]);let y=t.get(p.id);if(!y)return;switch(r){case"painting":return d.target===e.id&&d.motivation&&d.motivation[0]==="painting"&&n.includes(y.type)&&(d.body=y),d;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};return i.canvas=t.get(e),i.canvas&&(i.annotationPage=t.get(i.canvas.items[0]),i.accompanyingCanvas=(a=i.canvas)!=null&&a.accompanyingCanvas?t.get((s=i.canvas)==null?void 0:s.accompanyingCanvas):void 0),i.annotationPage&&(i.annotations=t.get(i.annotationPage.items).filter(o)),i};var Xe=(t,e)=>{let r=ee(t,{id:e,type:"Canvas"},"painting",["Image","Sound","Video"]);if(r.annotations.length!==0&&r.annotations[0]&&r.annotations[0].body)return r.annotations[0].body};var Je=(t,e,r)=>{let n=t.get({id:e,type:"Canvas"});if(!(n!=null&&n.annotations)||!n.annotations[0])return[];let i=t.get(n.annotations[0]),o=t.get(i.items);return Array.isArray(o)?o.filter(a=>{var s;if(!!a.body&&(s=a.motivation)!=null&&s.includes("supplementing")){let d=a.body;Array.isArray(d)&&(d=d[0]);let p=t.get(d.id);if(p.format===r)return a.body=p,a}}).map(a=>a.body):[]};var k=(t,e="en")=>{if(!t)return"";if(!t[e]){let r=Object.getOwnPropertyNames(t);if(r.length>0)return t[r[0]]}return t[e]};var et=(t,e,r,n)=>{let i=[];if(e.canvas&&e.canvas.thumbnail.length>0){let s=t.get(e.canvas.thumbnail[0]);i.push(s)}if(e.annotations[0]){if(e.annotations[0].thumbnail&&e.annotations[0].thumbnail.length>0){let d=t.get(e.annotations[0].thumbnail[0]);i.push(d)}if(!e.annotations[0].body)return;let s=e.annotations[0].body;s.type==="Image"&&i.push(s)}return i.length===0?void 0:{id:i[0].id,format:i[0].format,type:i[0].type,width:r,height:n}};import{createStitches as Mo}from"@stitches/react";var Po={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"#006adc",accentMuted:"#5eb0ef",accentAlt:"#00254d",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fonts:{sans:"'Inter', Arial, sans-serif",display:"'Calistoga', 'Inter', Arial, sans-serif"},transitions:{all:"all 500ms cubic-bezier(0.16, 1, 0.3, 1)"}},tt={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",xl:"(max-width: 1199px)",lg:"(min-width: 1200px)"},{styled:m,css:ls,keyframes:Pr,createTheme:us}=Mo({theme:Po,media:tt});import*as Ie from"@radix-ui/react-collapsible";var rt=m("div",{position:"relative",zIndex:"0"}),nt=m("div",{display:"flex",flexDirection:"row",overflow:"hidden","@sm":{flexDirection:"column"}}),it=m("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),Nr=m(Ie.Trigger,{display:"none",background:"transparent",border:"none",margin:"0",padding:"0",transition:"$all",opacity:"1",marginTop:"0","&[data-navigator='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",margin:"1rem 1rem 0"}}}),ot=m(Ie.Content,{width:"100%",display:"flex"}),Lr=m("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%","@sm":{width:"100%"}}),Dr=m("section",{display:"flex",flexDirection:"column",padding:"1.618rem",fontFamily:"$sans",backgroundColor:"$secondary",fontSmooth:"auto",webkitFontSmoothing:"antialiased","> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start","@sm":{[`& ${nt}`]:{flexGrow:"1"},[`& ${it}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-navigator-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${rt}`]:{display:"none"},[`& ${ot}`]:{height:"100%"}}}});import{useEffect as No,useState as Lo}from"react";var Fr=t=>{let e=()=>window.matchMedia?window.matchMedia(t).matches:!1,[r,n]=Lo(e);return No(()=>{let i=()=>n(e);return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)}),r};import{useEffect as Do,useLayoutEffect as Fo,useState as Vo}from"react";var Vr=(t=!1)=>{let[e,r]=Vo(t);return Fo(()=>{if(!e)return;let n=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=n}},[e]),Do(()=>{e!==t&&r(t)},[t]),[e,r]};import*as Bn from"@radix-ui/react-collapsible";import B from"react";import{Popover as $r}from"@nulib/design-system";var jr=m($r.Trigger,{width:"30px",padding:"5px"}),Wr=m($r.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",button:{display:"flex",textDecoration:"none",fontFamily:"$sans",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none",["&:last-child"]:{marginBottom:"0"}}}),_r=m("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",padding:"0 0 0.5rem",span:{fontSize:"1.25rem",fontWeight:"700",fontFamily:"$display","@sm":{padding:"1rem",fontSize:"1rem"}}});import{Popover as qo}from"@nulib/design-system";import N from"react";var $o=()=>{let t="#ed1d33",e="#2873ab";return N.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},N.createElement("title",null,"IIIF Manifest Options"),N.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},N.createElement("g",{transform:"scale(0.1)"},N.createElement("path",{style:{fill:e},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),N.createElement("path",{style:{fill:e},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),N.createElement("path",{style:{fill:t},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),N.createElement("path",{style:{fill:t},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),N.createElement("path",{style:{fill:e},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),N.createElement("path",{style:{fill:e},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),N.createElement("path",{style:{fill:t},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},zr=$o;import at from"react";import{useCallback as jo,useEffect as Wo,useState as _o}from"react";var Br=(t,e=2500)=>{let[r,n]=_o(),i=jo(()=>{navigator.clipboard.writeText(t).then(()=>n("copied"),()=>n("failed"))},[t]);return Wo(()=>{if(!r)return;let o=setTimeout(()=>n(void 0),e);return()=>clearTimeout(o)},[r]),[r,i]};var zo=m("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),Bo=({status:t})=>t?at.createElement(zo,{"data-copy-status":t},t):null,Uo=({textPrompt:t,textToCopy:e})=>{let[r,n]=Br(e);return at.createElement("button",{onClick:n},t," ",at.createElement(Bo,{status:r}))},Ur=Uo;var Ho=({manifestId:t,manifestLabel:e})=>{let r=D(),{configOptions:n}=r;return B.createElement(_r,null,n.showTitle&&B.createElement("span",null,k(e,"en")),n.showIIIFBadge&&B.createElement(qo,null,B.createElement(jr,null,B.createElement(zr,null)),B.createElement(Wr,null,B.createElement("button",{onClick:i=>{i.preventDefault(),window.open(t,"_blank")}},"View Manifest"),B.createElement(Ur,{textPrompt:"Copy Manifest URL",textToCopy:t}))))},qr=Ho;import P from"react";import ae,{useEffect as lt,useState as ut}from"react";import*as Hr from"@radix-ui/react-radio-group";var Gr=m(Hr.Root,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem 0.618rem 1.618rem 0 ",overflowX:"scroll",position:"relative",zIndex:"0","@sm":{padding:"1rem"}});import O from"react";var Go=t=>{var e=t.toString().split(":"),r=Math.ceil(parseInt(e[0])),n=Math.ceil(parseInt(e[1])),i=Qo(Math.ceil(parseInt(e[2])),2);let a=`${r!==0&&n<10?(n+"").padStart(2,"0"):n}:${i}`;return r!==0&&(a=`${r}:${a}`),a},Ae=t=>{let e=new Date(t*1e3).toISOString().substr(11,8);return Go(e)};var Qo=(t,e)=>String(t).padStart(e,"0");import{Icon as de,Tag as Yo}from"@nulib/design-system";import*as Yr from"@radix-ui/react-radio-group";import{Tag as Qr}from"@nulib/design-system";var Ee=m("span",{display:"flex"}),Kr=m("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),Zr=m("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),Xr=m(Yr.Item,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},"@sm":{margin:"0 1rem 0 0","&:last-child":{marginRight:"0"}},figure:{margin:"0",width:"161.8px","@sm":{width:"123px"},"> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all","@sm":{height:"76px"},img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${Ee}`]:{position:"absolute",right:"0.5rem",bottom:"0.5rem","@sm":{right:"0",bottom:"0"},[`& ${Qr}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary","@sm":{borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}}},figcaption:{marginTop:"0.5rem",color:"$primaryMuted",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${Ee}`]:{[`& ${Qr}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700",color:"$primary"}}});var Ko=({type:t})=>{switch(t){case"Sound":return O.createElement(de.Audio,null);case"Image":return O.createElement(de.Image,null);case"Video":return O.createElement(de.Video,null);default:return O.createElement(de.Image,null)}},Zo=({canvas:t,canvasIndex:e,isActive:r,thumbnail:n,type:i,handleChange:o})=>{let a=k(t.label,"en");return O.createElement(Xr,{"aria-checked":r,"data-testid":"media-thumbnail","data-canvas":e,onClick:()=>o(t.id),value:t.id},O.createElement("figure",null,O.createElement("div",null,(n==null?void 0:n.id)&&O.createElement("img",{src:n.id,alt:a}),O.createElement(Ee,null,O.createElement(Yo,{isIcon:!0,"data-testid":"thumbnail-tag"},O.createElement(Kr,null),O.createElement(de,{"aria-label":i},O.createElement(Ko,{type:i})),["Video","Sound"].includes(i)&&O.createElement(Zr,null,Ae(t.duration))))),O.createElement("figcaption",{"data-testid":"fig-caption"},a)))},Jr=Zo;var en=t=>t.body?t.body.type:"Image";import I,{useEffect as ea,useState as ct}from"react";var st=m("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),tn=m("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"$sans",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),pe=m("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),rn=m("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"},[`& ${pe}`]:{}}),nn=m("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${st}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}});import{useEffect as Xo}from"react";var Jo=(t,e)=>{Xo(()=>{function r(n){n.key===t&&e()}return window.addEventListener("keyup",r),()=>window.removeEventListener("keyup",r)},[])},on=Jo;var ta=()=>I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},I.createElement("title",null,"Arrow Back"),I.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),ra=()=>I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},I.createElement("title",null,"Arrow Forward"),I.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),na=()=>I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},I.createElement("title",null,"Close"),I.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),ia=()=>I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},I.createElement("title",null,"Search"),I.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),oa=({handleCanvasToggle:t,handleFilter:e,activeIndex:r,canvasLength:n})=>{let[i,o]=ct(!1),[a,s]=ct(!1),[d,p]=ct(!1);ea(()=>{p(r===0),r===n-1?s(!0):s(!1)},[r]),on("Escape",()=>{o(!1),e("")});let y=()=>{o(v=>!v),e("")};return I.createElement(nn,{isToggle:i},I.createElement(st,null,i&&I.createElement(tn,{autoFocus:!0,onChange:v=>e(v.target.value),placeholder:"Search"}),!i&&I.createElement(rn,null,I.createElement(pe,{onClick:()=>t(-1),disabled:d,type:"button"},I.createElement(ta,null)),I.createElement("span",null,r+1," of ",n),I.createElement(pe,{onClick:()=>t(1),disabled:a,type:"button"},I.createElement(ra,null))),I.createElement(pe,{onClick:y,type:"button"},i?I.createElement(na,null):I.createElement(ia,null))))},an=oa;var aa=({items:t})=>{let e=we(),r=D(),{activeCanvas:n,vault:i}=r,[o,a]=ut(""),[s,d]=ut([]),[p,y]=ut(0),b=ae.useRef(null),v="painting",w=["Image","Sound","Video"],h=u=>{n!==u&&e({type:"updateActiveCanvas",canvasId:u})};return lt(()=>{for(let u of t){let f=ee(i,u,v,w);f.annotations.length>0&&d(C=>[...C,f])}},[]),lt(()=>{s.forEach((u,f)=>{u!=null&&u.canvas&&u.canvas.id===n&&y(f)})},[n]),lt(()=>{let u=document.querySelector(`[data-canvas="${p}"]`);if(u instanceof HTMLElement&&b.current){let f=u.offsetLeft-b.current.offsetWidth/2+u.offsetWidth/2;b.current.scrollTo({left:f,behavior:"smooth"})}},[p]),ae.createElement(ae.Fragment,null,ae.createElement(an,{handleFilter:u=>a(u),handleCanvasToggle:u=>{let f=s[p+u];f!=null&&f.canvas&&h(f.canvas.id)},activeIndex:p,canvasLength:s.length}),ae.createElement(Gr,{"aria-label":"select item","data-testid":"media",ref:b},s.filter(u=>{var f;if((f=u.canvas)!=null&&f.label){let C=k(u.canvas.label);if(Array.isArray(C))return C[0].toLowerCase().includes(o.toLowerCase())}}).map((u,f)=>{var C,A;return ae.createElement(Jr,{canvas:u.canvas,canvasIndex:f,handleChange:h,isActive:n===((C=u==null?void 0:u.canvas)==null?void 0:C.id),key:(A=u==null?void 0:u.canvas)==null?void 0:A.id,thumbnail:et(i,u,200,200),type:en(u.annotations[0])})})))},sn=aa;import q,{useEffect as fa,useState as ma}from"react";import*as U from"@radix-ui/react-tabs";var cn=m(U.Root,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",boxShadow:"-5px -5px 5px #00000011","@sm":{marginTop:"0.5rem",boxShadow:"none"},"&:after":{position:"absolute",bottom:0,content:"",width:"100%",height:"1rem",backgroundImage:"linear-gradient(0deg, #FFFFFF 0%, #FFFFFF00 100%)",zIndex:1,"@sm":{backgroundImage:"none"}}}),ln=m(U.List,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid $secondaryAlt",backgroundColor:"$secondary","@sm":{margin:"0 1rem"}}),un=m(U.Trigger,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",color:"$primaryMuted",border:"none",fontFamily:"inherit",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:700,transition:"$all","&::after":{width:"0",height:"4px",content:"",backgroundColor:"$primaryMuted",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&:hover":{color:"$primary"},"&[data-state='active']":{color:"$accent","&::after":{width:"100%",backgroundColor:"$accent"}}}),dn=m(U.Content,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1rem 0"}}),pn=m("div",{position:"relative",height:"100%",width:"100%",overflowY:"scroll"});import pt,{useEffect as ua}from"react";import*as Se from"@radix-ui/react-radio-group";var fn=Pr({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),mn=m(Se.Root,{display:"flex",flexDirection:"column",width:"100%"}),Te=m(Se.Item,{position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"$primaryMuted",border:"none",background:"none","@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{color:"$primary",backgroundColor:"$secondaryMuted",fontFamily:"$sansBold","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:fn,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:fn,boxSizing:"content-box","@sm":{content:"unset"}}}});import{v4 as sa}from"uuid";var ca=()=>{function t(i){return i.map(a=>{let s=a.identifier||sa();return g(l({},a),{identifier:s})})}function e(i){let o=t(i);function a(d,p){let y=[];return d.forEach(b=>{let w=d.filter(h=>b.start>=h.start&&b.end<=h.end&&b.identifier!==h.identifier).sort((h,x)=>{let c=h.end-h.start,u=x.end-x.start;return c===u?0:c<u?-1:1})[0];if(!w&&!p||(w==null?void 0:w.identifier)===p){let h=a(d,b.identifier);h.length&&(b.children=h),y.push(b)}}),y}return a(o,null)}function r(i,o=[]){return o.some(a=>i.start>=a.start&&i.end<=a.end)}function n(i=[]){return i.sort((o,a)=>o.start-a.start)}return{addIdentifiersToParsedCues:t,createNestedCues:e,isChild:r,orderCuesByTime:n}},hn=ca;import Oe from"react";import dt from"react";import Re from"react";var gn={currentTime:0,startTime:0,updateStartTime:()=>{},updateCurrentTime:()=>{}},fe=Re.createContext(gn),yn=({children:t})=>{let[e,r]=Re.useState(gn.currentTime),[n,i]=Re.useState(0),o=s=>i(s),a=s=>r(s);return Re.createElement(fe.Provider,{value:{currentTime:e,startTime:n,updateStartTime:o,updateCurrentTime:a}},t)};var la=({label:t,start:e,end:r})=>{let{currentTime:n,updateStartTime:i}=dt.useContext(fe),o=e<=n&&n<r;return dt.createElement(Te,{"aria-checked":o,"data-testid":"navigator-cue",onClick:()=>{i(e)},value:t},t,dt.createElement("strong",null,Ae(e)))},vn=la;var bn=m("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${Te}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}});var Cn=({items:t})=>Oe.createElement(bn,null,t.map(({text:e,start:r,end:n,children:i,identifier:o})=>Oe.createElement("li",{key:o},Oe.createElement(vn,{label:e,start:r,end:n}),i&&Oe.createElement(Cn,{items:i})))),xn=Cn;import{parse as da}from"node-webvtt";var pa=({resource:t})=>{let[e,r]=pt.useState([]),{id:n,label:i}=t,{createNestedCues:o,orderCuesByTime:a}=hn();return ua(()=>{fetch(n,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(s=>s.text()).then(s=>{let d=da(s).cues,p=a(d),y=o(p);r(y)}).catch(s=>console.error(n,s.toString()))},[n]),pt.createElement(mn,{"aria-label":`navigate ${k(i,"en")}`},pt.createElement(xn,{items:e}))},wn=pa;var ha=({activeCanvas:t,defaultResource:e,resources:r})=>{let[n,i]=ma(e);fa(()=>{i(e)},[t,r]);let o=a=>{i(a)};return r?q.createElement(cn,{"data-testid":"navigator",defaultValue:e,onValueChange:o,orientation:"horizontal",value:n},q.createElement(ln,{"aria-label":"select chapter","data-testid":"navigator-list"},r.map(({id:a,label:s})=>q.createElement(un,{key:a,value:a},k(s,"en")))),q.createElement(pn,null,r.map(a=>q.createElement(dn,{key:a.id,value:a.id},q.createElement(wn,{resource:a}))))):q.createElement(q.Fragment,null)},In=ha;import j from"react";import me from"hls.js";var An=m("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",maxHeight:"450px",zIndex:"1",video:{backgroundColor:"transparent",display:"flex",position:"relative",objectFit:"contain",width:"100%",height:"100%",zIndex:"1"}});import ke from"react";var En=m("canvas",{position:"absolute",width:"100%",height:"100%"});var ga=ke.forwardRef((t,e)=>{let r=ke.useRef(null);ke.useEffect(()=>{!e||(e.current.onplay=n)},[e]);function n(){let o=e.current,a=new AudioContext,s=a.createMediaElementSource(o),d=a.createAnalyser(),p=r.current;if(!p)return;p.width=o.offsetWidth,p.height=o.offsetHeight;let y=p.getContext("2d");s.connect(d),d.connect(a.destination),d.fftSize=256;let b=d.frequencyBinCount,v=new Uint8Array(b);setInterval(function(){i(d,y,b,v,p.width,p.height)},20)}function i(o,a,s,d,p,y){let b=p/s*2.6,v,w=0;o.getByteFrequencyData(d),a.fillStyle="#000000",a.fillRect(0,0,p,y);for(let h=0;h<s;h++)v=d[h]*2,a.fillStyle=`rgba(${78}, 42, 132, 1)`,a.fillRect(w,y-v,b,v),w+=b+6}return ke.createElement(En,{ref:r})}),Sn=ga;import ya from"react";var va=({resource:t,ignoreCaptionLabels:e})=>{let r=k(t.label,"en");return r.some(i=>e.includes(i))?null:ya.createElement("track",{key:t.id,src:t.id,label:r,srcLang:"en","data-testid":"player-track"})},Tn=va;var ba=({painting:t,resources:e})=>{var w;let r=j.useRef(null),n=(w=t==null?void 0:t.format)==null?void 0:w.includes("audio/"),{startTime:i,updateCurrentTime:o}=j.useContext(fe),a=D(),{activeCanvas:s,configOptions:d,vault:p}=a,y=ee(p,{id:s,type:"Canvas"},"painting",["Image"]),b=Ze(y.accompanyingCanvas);j.useEffect(()=>{if(!t.id||!r.current||t.id.split(".").pop()!=="m3u8")return;let h=new me;return h.attachMedia(r.current),h.on(me.Events.MEDIA_ATTACHED,function(){h.loadSource(t.id)}),h.on(me.Events.ERROR,function(x,c){if(c.fatal)switch(c.type){case me.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${x} network error encountered, try to recover`),h.startLoad();break;case me.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${x} media error encountered, try to recover`),h.recoverMediaError();break;default:h.destroy();break}}),()=>{h&&(h.detachMedia(),h.destroy(),o(0))}},[t.id]),j.useEffect(()=>{let h=r.current;h&&(h.currentTime=i),i!==0&&h.play()},[i]);let v=()=>{let h=r.current;h&&(h.ontimeupdate=x=>{o(x.target.currentTime)})};return j.createElement(An,null,j.createElement("video",{id:"clover-iiif-video",key:t.id,ref:r,controls:!0,height:t.height,width:t.width,onPlay:v,crossOrigin:"anonymous",poster:b},j.createElement("source",{src:t.id,type:t.format}),e.length>0&&e.map(h=>j.createElement(Tn,{resource:h,ignoreCaptionLabels:d.ignoreCaptionLabels,key:h.id})),"Sorry, your browser doesn't support embedded videos."),n&&j.createElement(Sn,{ref:r}))},Rn=ba;import Pe,{useEffect as mt,useState as Fn}from"react";import Aa from"openseadragon";var On=m("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px","#openseadragon-navigator-displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"}}),kn=m("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),Mn=m("div",{width:"100%",height:"450px",background:"black",backgroundSize:"contain",color:"white",position:"relative",zIndex:"1",overflow:"hidden"});import M from"react";import ft from"react";import{styled as Ca}from"@stitches/react";var Pn=Ca("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",backgroundColor:"#000D",filter:"drop-shadow(5px 5px 5px #0006)",transition:"$all",boxSizing:"content-box !important",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(5px 5px 5px #000D)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&#zoomReset":{"&:hover, &:focus":{svg:{rotate:"45deg"}}}});var xa=({id:t,label:e,children:r})=>ft.createElement(Pn,{id:t,"data-testid":"openseadragon-button"},ft.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${t}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},ft.createElement("title",{id:`${t}-svg-title`},e),r)),Me=xa;import{styled as wa}from"@stitches/react";var Nn=wa("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem"});var Ia=()=>M.createElement(Nn,{"data-testid":"openseadragon-controls",id:"openseadragon-controls"},M.createElement(Me,{id:"zoomIn",label:"zoom in"},M.createElement(()=>M.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),null)),M.createElement(Me,{id:"zoomOut",label:"zoom in"},M.createElement(()=>M.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),null)),M.createElement(Me,{id:"zoomReset",label:"reset zoom"},M.createElement(()=>M.createElement(M.Fragment,null,M.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),M.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),null))),Ln=Ia;var Dn=t=>fetch(`${t.replace(/\/$/,"")}/info.json`).then(e=>e.json()).then(e=>e).catch(e=>{console.error(`The IIIF tilesource ${t.replace(/\/$/,"")}/info.json failed to load: ${e}`)});var Ea=({service:t})=>{let[e,r]=Fn(),[n,i]=Fn();mt(()=>(o(),()=>{e==null||e.destroy()}),[]),mt(()=>{Array.isArray(t)&&i(t[0])},[t]),mt(()=>{if(n){let a;"@id"in n?a=n["@id"]:a=n.id,a&&Dn(a).then(s=>e==null?void 0:e.open(s))}},[e,n]);function o(){let a={homeButton:"zoomReset",showFullPageControl:!1,zoomInButton:"zoomIn",zoomOutButton:"zoomOut"},s={showNavigator:!0,navigatorBorderColor:"transparent",navigatorId:"openseadragon-navigator"};r(Aa(l(l({id:"openseadragon-viewport",loadTilesWithAjax:!0},a),s)))}return Pe.createElement(Mn,{"data-testid":"image-viewer"},Pe.createElement(Ln,null),Pe.createElement(On,{id:"openseadragon-navigator"}),Pe.createElement(kn,{id:"openseadragon-viewport"}))},Vn=Ea;import{Button as Sa}from"@nulib/design-system";var Ta=({activeCanvas:t,painting:e,resources:r,items:n,isMedia:i,isNavigator:o,isNavigatorOpen:a})=>P.createElement(nt,null,P.createElement(yn,null,P.createElement(it,null,i?P.createElement(Rn,{painting:e,resources:r}):P.createElement(Vn,l({},e)),P.createElement(Nr,{"data-navigator":o},P.createElement(Sa,{as:"span"},a?"View Media Items":"View Navigator")),n.length>1&&P.createElement(rt,null,P.createElement(sn,{items:n,activeItem:0}))),o&&P.createElement(Lr,null,P.createElement(ot,null,P.createElement(In,{activeCanvas:t,defaultResource:r[0].id,resources:r}))))),$n=Ta;import ht from"react";var jn=m("div",{display:"flex",flexDirection:"column",alignItems:"center"}),Wn=m("p",{fontFamily:"$display",fontWeight:"bold",fontSize:"x-large"}),_n=m("span",{fontSize:"medium"});var Ra=({error:t})=>{let{message:e}=t;return ht.createElement(jn,{role:"alert"},ht.createElement(Wn,{"data-testid":"headline"},"Something went wrong"),e&&ht.createElement(_n,null,`Error message: ${e}`," "))},zn=Ra;import{ErrorBoundary as Oa}from"react-error-boundary";var ka=({manifest:t,theme:e})=>{let r=D(),{activeCanvas:n,vault:i}=r,[o,a]=ge(!1),[s,d]=ge(!1),[p,y]=ge(!0),[b,v]=ge(void 0),[w,h]=ge([]),[x,c]=Vr(!1),u=Fr(tt.sm);return gt(()=>{if(!u){y(!0);return}y(!1)},[u]),gt(()=>{if(!u){c(!1);return}c(p)},[p]),gt(()=>{let f=Xe(i,n),C=Je(i,n,"text/vtt");f&&(a(["Sound","Video"].indexOf(f.type)>-1),v(l({},f))),h(C),d(C.length!==0)},[n]),he.createElement(Oa,{FallbackComponent:zn},he.createElement(Dr,{className:e,"data-body-locked":x,"data-navigator":s,"data-navigator-open":p},he.createElement(Bn.Root,{open:p,onOpenChange:y},he.createElement(qr,{manifestLabel:t.label,manifestId:t.id}),he.createElement($n,{activeCanvas:n,painting:b,resources:w,items:t.items,isMedia:o,isNavigator:s,isNavigatorOpen:p}))))},Un=ka;import{createTheme as Pa}from"@stitches/react";var Na=({manifestId:t,canvasIdCallback:e=()=>{},customTheme:r,options:n})=>W.createElement(kr,null,W.createElement(La,{manifestId:t,canvasIdCallback:e,customTheme:r,options:n})),La=({manifestId:t,canvasIdCallback:e,customTheme:r,options:n})=>{let i=we(),o=D(),{activeCanvas:a,isLoaded:s,vault:d}=o,[p,y]=Ma(),b={};return r&&(b=Pa("custom",r)),qn(()=>{e&&e(a)},[a]),qn(()=>{i({type:"updateConfigOptions",configOptions:n}),d.loadManifest(t).then(v=>{y(v),i({type:"updateActiveCanvas",canvasId:v.items[0]&&v.items[0].id})}).catch(v=>{console.error(`Manifest failed to load: ${v}`)}).finally(()=>{i({type:"updateIsLoaded",isLoaded:!0})})},[]),s?!p||!p.items?(console.log(`The IIIF manifest ${t} failed to load.`),W.createElement(W.Fragment,null)):p.items.length===0?(console.log(`The IIIF manifest ${t} does not contain canvases.`),W.createElement(W.Fragment,null)):W.createElement(Un,{manifest:p,theme:b}):W.createElement(W.Fragment,null,"Loading")},uu=Na;export{uu as default};
//# sourceMappingURL=index.esm.js.map
